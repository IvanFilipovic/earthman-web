import{_ as g}from"./wm0FsEjJ.js";import{d as P,n as b}from"#entry";import{C as h,k as n,b as _,D as w,F as u,a3 as e,a7 as k,J as d,a4 as I,N as x,Y as y,X as p,a5 as N}from"./Cvp-EZ-T.js";const q={class:"min-h-screen bg-background_color flex items-center justify-center"},C={class:"max-w-md mx-auto px-4 text-center"},L={key:0,class:"space-y-4"},B={key:1,class:"space-y-4"},M={class:"text-sm text-text_color/70"},R={class:"flex flex-col gap-3 mt-6"},j=h({__name:"success",setup(T){const o=P(),l=n(()=>o.query.paymentId),c=n(()=>o.query.PayerID),i=n(()=>o.query.order_ref),f=n(()=>o.query.payment_session_id),r=_(!0),s=_("");async function v(){if(!l.value||!c.value||!i.value){s.value="Missing payment parameters",r.value=!1;return}try{console.log("Executing PayPal payment:",{paymentId:l.value,payerId:c.value,orderRef:i.value});const a=await $fetch("/api/paypal/execute",{method:"POST",body:{payment_id:l.value,payer_id:c.value,order_reference:i.value,payment_session_id:f.value}});a.success?await b({path:"/thank-you",query:{ref:a.order_reference,total:a.total_price,payment_intent:"completed"}}):(s.value="Payment execution failed. Please contact support.",r.value=!1)}catch(a){console.error("PayPal execution error:",a),s.value=a?.data?.message||"Payment failed. Please try again or contact support.",r.value=!1}}return w(()=>{v()}),(a,t)=>{const m=g;return p(),u("section",q,[e("div",C,[d(r)?(p(),u("div",L,[...t[0]||(t[0]=[e("div",{class:"animate-spin rounded-full h-16 w-16 border-b-2 border-primary_button_color mx-auto"},null,-1),e("h2",{class:"text-xl uppercase tracking-widest text-text_color"},"Processing Payment...",-1),e("p",{class:"text-sm text-text_color/70"},"Please wait while we confirm your PayPal payment",-1)])])):d(s)?(p(),u("div",B,[t[3]||(t[3]=e("div",{class:"w-16 h-16 bg-error_text_color/10 rounded-full flex items-center justify-center mx-auto"},[e("svg",{class:"w-8 h-8 text-error_text_color",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),t[4]||(t[4]=e("h2",{class:"text-xl uppercase tracking-widest text-error_text_color"},"Payment Failed",-1)),e("p",M,I(d(s)),1),e("div",R,[x(m,{to:"/checkout",class:"btn btn--primary"},{default:y(()=>[...t[1]||(t[1]=[e("span",{class:"btn__text"},"Try Again",-1),e("span",{class:"btn__fill"},null,-1)])]),_:1}),x(m,{to:"/",class:"text-sm underline text-text_color/70 hover:text-text_color"},{default:y(()=>[...t[2]||(t[2]=[N(" Return Home ",-1)])]),_:1})])])):k("",!0)])])}}});export{j as default};
