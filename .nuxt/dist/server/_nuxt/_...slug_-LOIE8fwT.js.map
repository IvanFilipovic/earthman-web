{"version":3,"file":"_...slug_-LOIE8fwT.js","sources":["../../../../components/CollectionShopListing.vue","../../../../pages/collections/[...slug].vue"],"sourcesContent":["<template>\n  <section class=\"overflow-y-auto pt-8 md:px-8 mt-6\">\n    <!-- Iterate over the precomputed layout sections -->\n    <div v-for=\"(section, idx) in sections\" :key=\"idx\">\n      <!-- PRODUCT GRIDS -->\n      <div v-if=\"section.type === 'grid'\" class=\"pb-10 md:pb-18\">\n        <!-- 3-up grid on md+ when count === 3; 2-up when count === 2. On small, always 2-up. -->\n        <div\n          :class=\"[\n            'grid gap-x-8 md:gap-x-12 gap-y-16 md:gap-y-14',\n            section.count === 3 ? 'grid-cols-2 md:grid-cols-3' : 'grid-cols-2 md:grid-cols-2',\n          ]\"\n        >\n          <article\n            v-for=\"item in section.items\"\n            :key=\"item.slug\"\n            class=\"group cursor-pointer\"\n          >\n            <div class=\"relative overflow-hidden\">\n              <img\n                @click=\"goToProduct(item.slug, item.colors?.[0]?.variant_slug)\"\n                :src=\"item.currentImage || item.link_image\"\n                :alt=\"item.alt_text || item.name\"\n                class=\"w-full h-full object-cover\"\n                loading=\"lazy\"\n              />\n\n              <!-- Minimal hover cue like Zara -->\n              <span\n                v-show=\"hoveredSlug === item.slug\"\n                class=\"absolute top-3 right-3 text-[10px] md:text-xs tracking-widest bg-background_color/80 px-2 py-1\"\n              >VIEW</span>\n            </div>\n\n            <!-- TEXT BLOCK UNDER CARD -->\n            <div class=\"pt-3 md:pt-4 text-left\">\n              <h3 class=\"uppercase tracking-wider text-sm font-normal truncate\">{{ item.name }}</h3>\n              <div class=\"mt-1 flex items-center gap-2\">\n                <!-- Tiny color swatches (existing logic kept) -->\n                <div\n                  v-for=\"(color, cIdx) in limitedColors(item.colors)\"\n                  :key=\"color.variant_slug || cIdx\"\n                  class=\"relative\"\n                  @mouseenter=\"onEnterColor(item, color)\"\n                  @mouseleave=\"onLeaveColor(item)\"\n                >\n                  <img\n                    :src=\"color.avatar_image\"\n                    :alt=\"color.color\"\n                    class=\"h-8 w-8 object-cover border border-project_black/40\"\n                    loading=\"lazy\"\n                    @click=\"goToProduct(item.slug, color.variant_slug)\"\n                  />\n                  <div class=\"absolute inset-0 pointer-events-none transition-opacity duration-200 w-8 h-8 bg-text_color\" :class=\"isColorHovered(item, color) ? 'opacity-100' : 'opacity-0'\" >\n                  <Icon\n                    name=\"lucide:square-arrow-out-up-right\"\n                    class=\"absolute inset-0 w-4 h-4 z-10 text-background_color m-auto\"\n                    \n                  />\n                </div>\n                </div>\n                <span v-if=\"extraColorsCount(item.colors) > 0\" class=\"text-[10px] md:text-xs\">+{{ extraColorsCount(item.colors) }}</span>\n              </div>\n              <p class=\"mt-1 text-xs font-light\">€{{ parseFloat(item.price).toFixed(2) }}</p>\n            </div>\n          </article>\n        </div>\n      </div>\n\n      <!-- TEXT SECTIONS FROM COLLECTION (images ignored) -->\n      <div v-else-if=\"section.type === 'text'\" class=\"py-6 md:py-14\">\n        <div class=\"max-w-none md:max-w-7xl\">\n          <h4 class=\"uppercase tracking-wider text-xs md:text-sm mb-3\">{{ section.heading }}</h4>\n          \n          <div class=\"flex flex-col max-w\">\n            <span\n              v-for=\"(line, i) in splitText(section.text)\"\n              :key=\"i\"\n              class=\"px-3 py-1 my-1 text-sm md:text-base leading-relaxed tracking-wide max-w-4xl bg-text_color text-background_color\"\n            >\n              {{ line }}\n            </span>\n          </div>\n        </div>\n      </div>\n    </div>\n  </section>\n</template>\n\n<script setup>\nimport { computed, ref } from 'vue'\nimport { useRouter } from 'vue-router'\n\n// Props: pass ALL products (already fetched) and the collection object\nconst props = defineProps({\n  products: { type: Array, default: () => [] },\n  collection: { type: Object, default: () => ({}) },\n})\n\nconst router = useRouter()\nconst hoveredSlug = ref(null)\nconst hoveredColorBySlug = ref({})\n\n\n\nfunction isColorHovered(item, color) {\n  return hoveredColorBySlug.value[item.slug] === color.variant_slug\n}\n\nfunction onEnterColor(item, color) {\n  hoveredSlug.value = item.slug\n  item.currentImage = color.avatar_image\n  hoveredColorBySlug.value[item.slug] = color.variant_slug\n}\n\nfunction onLeaveColor(item) {\n  item.currentImage = item.defaultImage || item.link_image\n  hoveredColorBySlug.value[item.slug] = null\n  hoveredSlug.value = null\n}\n\nfunction goToProduct(slug, variant_slug) {\n  if (!slug || !variant_slug) return\n  router.push(`/product/${slug}/${variant_slug}`)\n}\n\n// Limit visible swatches like the reference UI, but keep logic intact\nfunction limitedColors(colors = []) {\n  return colors.slice(0, 2)\n}\nfunction extraColorsCount(colors = []) {\n  return Math.max(0, colors.length - 2)\n}\n\n// --- LAYOUT LOGIC -----------------------------------------------------------\n// Build sections in the order:\n// 3 products → text → 2 products → 3 products → text → 2 products → text → 3 products → ... until products are exhausted\n\nconst textPool = computed(() => {\n  // pull available non-empty text fields from the collection, ignoring images\n  const c = props.collection || {}\n  const texts = [\n    c.element_one,\n    c.element_two,\n    c.element_three,\n    c.element_four,\n  ].filter(Boolean)\n  return texts.length ? texts : [''] // ensure at least empty string\n})\n\nconst sections = computed(() => {\n  const items = [...props.products]\n  const result = []\n  let i = 0 // product index\n  let textIndex = 0\n\n  // repeating pattern blueprint; we'll loop over it until we run out of products\n  const pattern = [\n    { type: 'grid', count: 3 },\n    { type: 'text' },\n    { type: 'grid', count: 2 },\n    { type: 'grid', count: 3 },\n    { type: 'text' },\n    { type: 'grid', count: 2 },\n    { type: 'text' },\n    { type: 'grid', count: 3 },\n  ]\n\n  let p = 0 // index in pattern\n  while (i < items.length) {\n    const step = pattern[p]\n\n    if (step.type === 'grid') {\n      if (i >= items.length) break\n      const slice = items.slice(i, i + step.count)\n      if (!slice.length) break\n      result.push({ type: 'grid', count: step.count, items: slice })\n      i += slice.length\n    } else if (step.type === 'text') {\n      // Insert a text block only if at least one product remains ahead to avoid trailing text only\n      if (i < items.length) {\n        result.push({\n          type: 'text',\n          heading: defaultHeading(textIndex),\n          text: textPool.value[textIndex % textPool.value.length],\n        })\n        textIndex++\n      }\n    }\n\n    p = (p + 1) % pattern.length\n  }\n\n  return result\n})\n\nfunction splitText(text = '') {\n  // Split by sentence or newline; adjust as needed\n  return text\n    .split(/(?<=[.!?])\\s+|\\n+/) // split by punctuation + space OR newline\n    .filter(Boolean)            // remove empty strings\n}\n\nfunction defaultHeading(idx) {\n  // Simple rotating headings; swap with collection.name if you prefer a fixed one\n  const base = props.collection?.name || 'Collection'\n  return idx === 0 ? `${base}` : `${base} — ${idx + 1}`\n}\n</script>\n\n<style scoped>\n/* Lean visuals with generous whitespace like the refs */\n</style>\n","<!-- pages/collection/[slug].vue -->\n<template>\n  <section>\n    <!-- Header -->\n    <div class=\"flex flex-col md:flex-row items-start md:items-center justify-between px-8 py-6 gap-6 border-b border-text_color/30\">\n      <div class=\"w-full md:w-1/2\">\n        <div class=\"image bg-cover bg-center bg-transparent h-40 flex justify-center max-w-[100%]\">\n        </div>\n      </div>\n\n      <div class=\"w-full md:w-1/2 flex flex-col\">\n        <AppNavigation :dark=\"false\" />\n        <div class=\"flex gap-3 justify-end w-full\">\n            <div class=\"flex items-center gap-3\">\n                <nav class=\"text-md uppercase tracking-widest space-x-2 text-background_color px-4\">\n                  <p>{{ collection.name }}</p>\n                </nav>\n            </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Gender Switch -->\n    <div class=\"flex flex-col md:flex-row items-start md:items-center justify-between px-8 pt-1 gap-6\">\n      <div class=\"flex justify-end w-full\">\n        <div class=\"flex items-center\">\n          <button\n            :class=\"genderBtnClass('female')\"\n            @click=\"setGender('female')\"\n          >WOMAN</button>\n          <button\n            :class=\"genderBtnClass('male')\"\n            @click=\"setGender('male')\"\n          >MAN</button>\n        </div>\n      </div>\n    </div>\n\n    <!-- Product Listing -->\n    <CollectionShopListing\n      v-if=\"!pending && products.length\"\n      :products=\"products\"\n      :collection=\"collection\"\n      @cta-click=\"onCtaClick\"\n    />\n  </section>\n</template>\n\n<script setup>\nimport { ref, computed, watch } from 'vue'\nimport { useRoute, useRouter } from '#imports'\n\n/* ──────────────────────────────\n   Route + gender state\n────────────────────────────── */\nconst route = useRoute()\nconst router = useRouter()\nconst slug = computed(() => String(route.params.slug))\nconst gender = ref(route.query.gender === 'male' ? 'male' : 'female')\n\n// sync local gender ↔ route query\nwatch(\n  () => route.query.gender,\n  (g) => {\n    const normalized = g === 'male' ? 'male' : 'female'\n    if (gender.value !== normalized) gender.value = normalized\n  },\n  { immediate: true }\n)\n\n// update URL when gender changes locally\nfunction setGender(value) {\n  if (gender.value !== value) {\n    gender.value = value\n    router.replace({ query: { ...route.query, gender: value } })\n  }\n}\n\n/* ──────────────────────────────\n   UI helpers\n────────────────────────────── */\nfunction genderBtnClass(target) {\n  const base = 'pl-8 py-1 text-sm text-text_color'\n  return [base, gender.value === target ? 'font-bold' : 'bg-background_color'].join(' ')\n}\n\n/* ──────────────────────────────\n   API calls\n────────────────────────────── */\nconst API = 'http://127.0.0.1:8000'\n\n// fetch collection data (not dependent on gender)\nconst { data: collectionData, pending: cPending } = await useAsyncData(\n  () => `collection:${slug.value}`,\n  () => $fetch(`${API}/public/collections/${slug.value}/`)\n)\n\n// fetch ALL products, refetches when slug or gender changes\nconst pageSize = 48\nconst { data: productsData, pending: pPending, refresh } = await useAsyncData(\n  // 👇 include gender in the key so Nuxt refetches when it changes\n  () => `products-all:${slug.value}:${gender.value}`,\n  async () => {\n    let url = `${API}/public/products-all/?page=1&page_size=${pageSize}&collection=${slug.value}&gender=${gender.value}`\n    const all = []\n\n    while (url) {\n      const res = await $fetch(url)\n      if (Array.isArray(res?.results)) all.push(...res.results)\n      url = res?.next || null\n    }\n\n    return all\n  },\n  // 👇 also explicitly watch reactive sources for extra safety\n  { watch: [slug, gender] }\n)\n\n/* ──────────────────────────────\n   Computed + handlers\n────────────────────────────── */\nconst pending = computed(() => cPending.value || pPending.value)\nconst collection = computed(() => collectionData.value || {})\nconst products = computed(() => productsData.value || [])\n\nfunction onCtaClick() {\n  if (process.client) window.scrollTo({ top: 0, behavior: 'smooth' })\n}\n</script>\n<style scoped>\n.image {\nbackground-image: url(\"public/logo/black_logo1.png\");\n}\n</style>\n\n"],"names":["_ssrRenderAttrs","_mergeProps","_ssrRenderAttr","_ssrInterpolate","_ssrRenderList","useRouter","_withAsyncContext","_ssrRenderComponent"],"mappings":"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"}