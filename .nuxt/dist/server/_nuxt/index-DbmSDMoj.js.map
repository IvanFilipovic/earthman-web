{"version":3,"file":"index-DbmSDMoj.js","sources":["../../../../components/ShopListing.vue","../../../../pages/shop/index.vue"],"sourcesContent":["<template>\n  <div class=\"flex flex-wrap overflow-y-auto pt-8 md:pl-8\">\n    <div\n      v-for=\"item in products\"\n      :key=\"item.slug\"\n      class=\"w-1/2 md:w-1/4 cursor-pointer pb-10\"\n    >\n      <div class=\"bg-background_color overflow-hidden object-fill\">\n        <div class=\"w-11/12 md:w-9/12\">\n          <div\n            class=\"relative bg-background_color\"\n            @mouseenter=\"hoveredSlug = item.slug\"\n            @mouseleave=\"hoveredSlug = null\"\n          >\n            <img\n              @click=\"goToProduct(item.slug, item.colors?.[0]?.variant_slug)\"\n              :src=\"item.currentImage || item.link_image\"\n              :alt=\"item.alt_text || item.name\"\n              class=\"max-w-[100%] h-auto object-cover transition-opacity duration-200 border border-project_black\"\n              loading=\"lazy\"\n            />\n\n            <button\n              v-show=\"hoveredSlug === item.slug\"\n              class=\"absolute top-4 right-2 \n                    bg-background_color text-text_color tracking-wider text-xs font-extralight \n                    w-auto px-2 mx-auto \n                    opacity-0 transition-opacity duration-200\"\n              :class=\"{ 'opacity-100': hoveredSlug === item.slug }\"\n              @click=\"goToProduct(item.slug, item.colors?.[0]?.variant_slug)\"\n            >\n              View\n            </button>\n          </div>\n\n          <!-- TEXT BLOCK -->\n          <div class=\"py-3 text-left\">\n            <h3 class=\"uppercase tracking-wider text-sm font-normal truncate\">{{ item.name }}</h3>\n\n            <div class=\"mt-1 flex items-center gap-2\">\n              <div\n                v-for=\"color in limitedColors(item.colors)\"\n                :key=\"color.variant_slug\"\n                class=\"relative group\"\n                @mouseenter=\"onEnterColor(item, color)\"\n                @mouseleave=\"onLeaveColor(item)\"\n              >\n                <img\n                  :src=\"color.avatar_image\"\n                  :alt=\"color.color\"\n                  class=\"h-8 w-8 object-cover\"\n                  loading=\"lazy\"\n                  @click=\"goToProduct(item.slug, color.variant_slug)\"\n                />\n\n                <!-- overlay icon; doesn't block mouse so leave works -->\n                <div class=\"absolute inset-0 pointer-events-none transition-opacity duration-200 w-8 h-8 bg-text_color\" :class=\"isColorHovered(item, color) ? 'opacity-100' : 'opacity-0'\" >\n                  <Icon\n                    name=\"lucide:square-arrow-out-up-right\"\n                    class=\"absolute inset-0 w-4 h-4 z-10 text-background_color m-auto\"\n                    \n                  />\n                </div>\n                \n              </div>\n              <span v-if=\"extraColorsCount(item.colors) > 0\" class=\"text-[10px] md:text-xs\">+{{ extraColorsCount(item.colors) }}</span>\n            </div>\n\n            <p class=\"mt-1 text-xs font-light\">â‚¬{{ parseFloat(item.price).toFixed(2) }}</p>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref } from \"vue\"\nimport { useRouter } from \"vue-router\"\n\ndefineProps({ products: { type: Array, default: () => [] } })\n\nconst hoveredSlug = ref(null)\nconst router = useRouter()\nconst hoveredColorBySlug = ref({})\n\nfunction isColorHovered(item, color) {\n  return hoveredColorBySlug.value[item.slug] === color.variant_slug\n}\n\nfunction onEnterColor(item, color) {\n  item.currentImage = color.avatar_image\n  hoveredColorBySlug.value[item.slug] = color.variant_slug\n}\n\nfunction onLeaveColor(item) {\n  item.currentImage = item.defaultImage || item.link_image\n  hoveredColorBySlug.value[item.slug] = null\n}\nfunction extraColorsCount(colors = []) {\n  return Math.max(0, colors.length - 2)\n}\nfunction limitedColors(colors = []) {\n  return colors.slice(0, 2)\n}\nfunction goToProduct(slug, variant_slug) {\n  if (!slug || !variant_slug) return\n  router.push(`/product/${slug}/${variant_slug}`)\n}\n</script>\n","<template>\n  <section>\n    <div class=\"flex flex-col md:flex-row items-start md:items-center justify-between px-8 py-6 gap-6 border-b border-text_color/30\">\n      <div class=\"w-full md:w-1/2\">\n        <div class=\"image bg-cover bg-center bg-transparent h-40 flex justify-center max-w-[100%]\">\n        </div>\n      </div>\n\n      <div class=\"w-full md:w-1/2 flex flex-col\">\n        <AppNavigation :dark=\"false\" />\n        <div class=\"flex gap-3 justify-end w-full\">\n            <div class=\"flex items-center gap-3\">\n                <span class=\"uppercase text-xs tracking-widest ml-4\">View</span>\n                <button\n                    v-for=\"p in totalPages\"\n                    :key=\"p\"\n                    :class=\"p === page ? 'underline' : 'opacity-60'\"\n                    class=\"text-sm uppercase tracking-widest\"\n                    @click=\"page = p\"\n                >{{ p }}</button>\n\n                <button class=\"text-md uppercase tracking-widest px-4\" @click=\"filterOpen = true\">Filters</button>\n            </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"flex flex-col md:flex-row items-start md:items-center justify-between px-8 pt-1 gap-6\">\n      <div class=\"flex justify-end w-full\">\n        <div class=\"flex items-center\">\n          <button\n          :class=\"genderBtnClass('female')\"\n          @click=\"setGender('female')\"\n          >WOMAN</button>\n          <button\n          :class=\"genderBtnClass('male')\"\n          @click=\"setGender('male')\"\n          >MAN</button>\n        </div>\n      </div>\n    </div>\n    <ShopListing class=\"mt-6\" :products=\"products\" />\n\n    <ClientOnly>\n      <FilterPanel\n        :open=\"filterOpen\"\n        v-model=\"filters\"\n        :facets=\"facets\"\n        @update:open=\"filterOpen = $event\"\n      />\n    </ClientOnly>\n  </section>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed, watch, onMounted } from 'vue'\nimport AppNavigation from '~/components/AppNavigation.vue'\n\nconst config = useRuntimeConfig()\n\nconst router = useRouter()\nconst route = useRoute()\nconst gender = ref(route.query.gender === 'male' ? 'male' : 'female')\n\nwatch(\n  () => route.query.gender,\n  (g) => {\n    const normalized = g === 'male' ? 'male' : 'female'\n    if (gender.value !== normalized) {\n      gender.value = normalized\n    }\n  },\n  { immediate: true }\n)\n\n// when clicking local buttons, also push to the URL\nfunction setGender(value: 'male' | 'female') {\n  if (gender.value !== value) {\n    gender.value = value\n    router.replace({ query: { ...route.query, gender: value } })\n  }\n}\n\n/* Active/inactive styles */\nfunction genderBtnClass(target: 'male' | 'female') {\n  const base = 'pl-8 py-1 text-sm text-text_color'\n  return [base, gender.value === target ? 'font-bold' : 'bg-background_color'].join(' ')\n}\n\n/* --------------------------\n   Page + Filters + Data\n-------------------------- */\ninterface Product {\n  id?: number\n  name?: string\n  link_image?: string\n  defaultImage?: string\n  currentImage?: string\n  [key: string]: any\n}\nconst products = ref<Product[]>([])\nconst count = ref(0)\nconst page = ref(1)\nconst pageSize = 12\nconst totalPages = computed(() => Math.max(1, Math.ceil(count.value / pageSize)))\nconst filterOpen = ref(false)\nconst filters = ref({ categories: [] as number[], sizes: [] as string[], colors: [] as string[] })\n\nconst facets = ref({\n  categories: [] as { id: number; name: string }[],\n  sizes: [] as { name: string }[],\n  colors: [] as { name: string; image: string }[]\n})\n\nfunction buildQuery() {\n  const p = new URLSearchParams()\n  filters.value.categories.forEach(id => p.append('category', id.toString()))\n  filters.value.sizes.forEach(s => p.append('size', s))\n  filters.value.colors.forEach(c => p.append('color', c))\n  p.set('gender', gender.value)  // sends \"male\" or \"female\"\n  p.set('page', String(page.value))\n  p.set('page_size', String(pageSize))\n  return p.toString().replace(/\\+/g, '%20')\n}\n\n/* --------------------------\n   Fetch functions\n-------------------------- */\nasync function fetchCategories () {\n  try {\n    const res = await $fetch(`${config.public.apiBase}/public/categories/`)\n    facets.value.categories = Array.isArray(res) ? res : []\n  } catch {\n    facets.value.categories = []\n  }\n}\nasync function fetchSizes () {\n  try {\n    const res = await $fetch(`${config.public.apiBase}/public/sizes/`)\n    facets.value.sizes = Array.isArray(res) ? res : []\n  } catch {\n    facets.value.sizes = []\n  }\n}\nasync function fetchColors () {\n  try {\n    const res = await $fetch(`${config.public.apiBase}/public/colors/`)\n    facets.value.colors = Array.isArray(res)\n      ? res.map((c: any) => ({ name: c.name, image: c.image }))\n      : []\n  } catch {\n    facets.value.colors = []\n  }\n}\nasync function fetchProducts() {\n  const res = await $fetch(`${config.public.apiBase}/public/products-all/?${buildQuery()}`, {\n    headers: {\n      'ngrok-skip-browser-warning': 'true',\n    },\n  }) as { count: number; results: any[] }\n  count.value = res.count\n  products.value = res.results.map(r => ({\n    ...r,\n    defaultImage: r.link_image,\n    currentImage: r.link_image\n  }))\n}\n\n/* --------------------------\n   Watchers + Lifecycle\n-------------------------- */\nwatch([filters, page, gender, route], fetchProducts)\n\nonMounted(async () => {\n  await Promise.all([fetchCategories(), fetchColors(), fetchSizes()])\n  await fetchProducts()\n})\n</script>\n\n<style scoped>\n.image {\nbackground-image: url(\"public/logo/black_logo1.png\");\n}\n</style>\n"],"names":["_ssrRenderAttrs","_mergeProps","_ssrRenderList","_ssrRenderAttr","_ssrInterpolate","useRouter","_ssrRenderComponent","AppNavigation","_ssrRenderClass"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkFA,UAAM,cAAc,IAAI,IAAI;AACb,cAAS;AACxB,UAAM,qBAAqB,IAAI,CAAA,CAAE;AAEjC,aAAS,eAAe,MAAM,OAAO;AACnC,aAAO,mBAAmB,MAAM,KAAK,IAAI,MAAM,MAAM;AAAA,IACvD;AAWA,aAAS,iBAAiB,SAAS,IAAI;AACrC,aAAO,KAAK,IAAI,GAAG,OAAO,SAAS,CAAC;AAAA,IACtC;AACA,aAAS,cAAc,SAAS,IAAI;AAClC,aAAO,OAAO,MAAM,GAAG,CAAC;AAAA,IAC1B;;;AAvGO,YAAA,OAAAA,eAAAC,WAAA,EAAA,OAAM,iDAA6C,MAAA,CAAA,CAAA,WAAA;AAErCC,oBAAA,QAAA,WAAR,SAAI;4MAaFC,cAAA,OAAK,KAAK,gBAAgB,KAAK,UAAU,IACzCA,cAAA,OAAK,KAAK,YAAY,KAAK,IAAI,yKAWP,YAAA,UAAgB,KAAK,KAAI,GAAA,iKAAA,CAAA,4BAL1C,YAAA,UAAgB,KAAK,OAAI,OAAA,EAAA,SAAA,OAAA,CAAA,yHAckCC,eAAA,KAAK,IAAI;AAI1DF,sBAAA,cAAc,KAAK,MAAM,IAAlC,UAAK;iEAOT,OAAK,MAAM,YAAY,kBACvB,OAAK,MAAM,KAAK,6EAO6F,eAAe,MAAM,KAAK,IAAA,gBAAA,aAAA,4FAAA,CAAA;;YAEtI,MAAK;AAAA,YACL,OAAM;AAAA;;;;YAMA,iBAAiB,KAAK,MAAM,IAAA,GAAA;wEAA0C,iBAAiB,KAAK,MAAM,CAAA,CAAA,SAAA;AAAA;;;AAGzE,cAAA,6CAAAE,eAAA,WAAW,KAAK,KAAK,EAAE,QAAO,CAAA,CAAA,CAAA,8BAAA;AAAA;;;;;;;;;;;ACkCjF,MAAM,WAAW;;;;;AA7CjB,UAAM,SAAS,iBAAA;AAEAC,gBAAA;AACf,UAAM,QAAQ,SAAA;AACd,UAAM,SAAS,IAAI,MAAM,MAAM,WAAW,SAAS,SAAS,QAAQ;AAEpE;AAAA,MACE,MAAM,MAAM,MAAM;AAAA,MAClB,CAAC,MAAM;AACL,cAAM,aAAa,MAAM,SAAS,SAAS;AAC3C,YAAI,OAAO,UAAU,YAAY;AAC/B,iBAAO,QAAQ;AAAA,QACjB;AAAA,MACF;AAAA,MACA,EAAE,WAAW,KAAA;AAAA,IAAK;AAYpB,aAAS,eAAe,QAA2B;AACjD,YAAM,OAAO;AACb,aAAO,CAAC,MAAM,OAAO,UAAU,SAAS,cAAc,qBAAqB,EAAE,KAAK,GAAG;AAAA,IACvF;AAaA,UAAM,WAAW,IAAe,EAAE;AAClC,UAAM,QAAQ,IAAI,CAAC;AACnB,UAAM,OAAO,IAAI,CAAC;AAElB,UAAM,aAAa,SAAS,MAAM,KAAK,IAAI,GAAG,KAAK,KAAK,MAAM,QAAQ,QAAQ,CAAC,CAAC;AAC7D,QAAI,KAAK;AAC5B,UAAM,UAAU,IAAI,EAAE,YAAY,CAAA,GAAgB,OAAO,CAAA,GAAgB,QAAQ,CAAA,GAAgB;AAElF,QAAI;AAAA,MACjB,YAAY,CAAA;AAAA,MACZ,OAAO,CAAA;AAAA,MACP,QAAQ,CAAA;AAAA,IAAC,CACV;AAED,aAAS,aAAa;AACpB,YAAM,IAAI,IAAI,gBAAA;AACd,cAAQ,MAAM,WAAW,QAAQ,CAAA,OAAM,EAAE,OAAO,YAAY,GAAG,SAAA,CAAU,CAAC;AAC1E,cAAQ,MAAM,MAAM,QAAQ,CAAA,MAAK,EAAE,OAAO,QAAQ,CAAC,CAAC;AACpD,cAAQ,MAAM,OAAO,QAAQ,CAAA,MAAK,EAAE,OAAO,SAAS,CAAC,CAAC;AACtD,QAAE,IAAI,UAAU,OAAO,KAAK;AAC5B,QAAE,IAAI,QAAQ,OAAO,KAAK,KAAK,CAAC;AAChC,QAAE,IAAI,aAAa,OAAO,QAAQ,CAAC;AACnC,aAAO,EAAE,SAAA,EAAW,QAAQ,OAAO,KAAK;AAAA,IAC1C;AA+BA,mBAAe,gBAAgB;AAC7B,YAAM,MAAM,MAAM,OAAO,GAAG,OAAO,OAAO,OAAO,yBAAyB,WAAA,CAAY,IAAI;AAAA,QACxF,SAAS;AAAA,UACP,8BAA8B;AAAA,QAAA;AAAA,MAChC,CACD;AACD,YAAM,QAAQ,IAAI;AAClB,eAAS,QAAQ,IAAI,QAAQ,IAAI,CAAA,OAAM;AAAA,QACrC,GAAG;AAAA,QACH,cAAc,EAAE;AAAA,QAChB,cAAc,EAAE;AAAA,MAAA,EAChB;AAAA,IACJ;AAKA,UAAM,CAAC,SAAS,MAAM,QAAQ,KAAK,GAAG,aAAa;;;;;AAjK3B,YAAAC,mBAAAC,aAAA,EAAA,MAAM,SAAK,MAAA,OAAA,CAAA;;AAKHL,oBAAA,WAAA,QAAL,MAAC;gCAEAM,eAAA,CAAA,MAAM,KAAA,QAAI,cAAA,cAAA,mCAAA,CAAA,qCAGlB,CAAC;;2XAWH,eAAc,QAAA,CAAA,kEAId,eAAc,MAAA,CAAA;;QAMf,OAAM;AAAA,QAAQ,UAAU,SAAA;AAAA,MAAA;;;;;;;;;;;;;"}