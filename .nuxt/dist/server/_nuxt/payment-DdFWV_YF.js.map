{"version":3,"file":"payment-DdFWV_YF.js","sources":["../../../../pages/payment.vue"],"sourcesContent":["<!-- pages/payment.vue -->\n<script setup lang=\"ts\">\nconst route = useRoute()\n\nconst clientSecret = computed(() => route.query.clientSecret as string)\nconst orderReference = computed(() => route.query.ref as string)\nconst amount = computed(() => route.query.amount as string)\n\nconst isProcessing = ref(false)\nconst errorMessage = ref('')\nconst isLoading = ref(true)\n\nlet stripe: any = null\nlet elements: any = null\n\nasync function initializeStripe() {\n  if (!clientSecret.value) {\n    errorMessage.value = 'Invalid payment session'\n    isLoading.value = false\n    return\n  }\n  if (typeof window === 'undefined') return\n\n  try {\n\n    // Dynamically load Stripe\n    const { loadStripe } = await import('@stripe/stripe-js')\n    const config = useRuntimeConfig()\n    \n    stripe = await loadStripe(config.public.stripePublishableKey)\n    \n    if (!stripe) {\n      throw new Error('Failed to load Stripe')\n    }\n\n    // Create elements with appearance\n    const appearance = {\n      theme: 'stripe' as const,\n      variables: {\n        colorPrimary: '#0040ff',\n        colorBackground: '#e2e2e2',\n        colorText: '#252525',\n        colorDanger: '#C90D00',\n        fontFamily: 'system-ui, sans-serif',\n        borderRadius: '4px',\n      },\n      rules: {\n        '.Input': {\n          border: '1px solid rgba(37, 37, 37, 0.3)',\n          padding: '12px',\n          marginBottom: '8px',\n        },\n        '.Label': {\n          fontSize: '12px',\n          fontWeight: '500',\n          textTransform: 'uppercase',\n        }\n      },\n    }\n\n    elements = stripe.elements({\n      clientSecret: clientSecret.value,\n      appearance,\n    })\n\n    const paymentElement = elements.create('payment', {\n      layout: 'tabs',\n    })\n\n    paymentElement.mount('#payment-element')\n    isLoading.value = false\n\n  } catch (error: any) {\n    console.error('❌ Error:', error)\n    errorMessage.value = error.message || 'Failed to load payment form'\n    isLoading.value = false\n  }\n}\n\nasync function handleSubmit(e: Event) {\n  e.preventDefault()\n  \n  if (!stripe || !elements) {\n    errorMessage.value = 'Payment system not ready'\n    return\n  }\n\n  isProcessing.value = true\n  errorMessage.value = ''\n\n  try {\n    const { error } = await stripe.confirmPayment({\n      elements,\n      confirmParams: {\n        return_url: `${window.location.origin}/thank-you?ref=${orderReference.value}&total=${amount.value}`,\n      },\n    })\n\n    if (error) {\n      if (error.type === 'card_error' || error.type === 'validation_error') {\n        errorMessage.value = error.message\n      } else {\n        errorMessage.value = 'An unexpected error occurred.'\n      }\n    }\n  } catch (err) {\n    errorMessage.value = 'Payment failed. Please try again.'\n    console.error('Payment error:', err)\n  } finally {\n    isProcessing.value = false\n  }\n}\n\n// Initialize when component is mounted on client\nonMounted(() => {\n  if (import.meta.client) {\n    initializeStripe()\n  }\n})\n</script>\n\n<template>\n  <section class=\"min-h-screen bg-background_color\">\n    <AppNavigation :dark=\"false\" />\n\n    <div class=\"max-w-2xl mx-auto px-4 py-12\">\n      <!-- Header -->\n      <div class=\"mb-8\">\n        <h1 class=\"text-2xl uppercase tracking-widest mb-2 text-text_color\">Complete Payment</h1>\n        <p class=\"text-sm text-text_color/70\">Order: {{ orderReference }}</p>\n      </div>\n\n      <!-- Payment Form -->\n      <form id=\"payment-form\" @submit=\"handleSubmit\" class=\"border border-text_color/30 p-6 md:p-8 mb-6\">\n        <!-- Total Amount -->\n        <div class=\"flex justify-between items-center mb-8 pb-6 border-b border-text_color/30\">\n          <span class=\"text-sm uppercase tracking-widest text-text_color font-medium\">Total Amount</span>\n          <span class=\"text-3xl font-semibold text-text_color\">€{{ amount }}</span>\n        </div>\n\n        <!-- Loading Spinner -->\n        <div v-if=\"isLoading\" class=\"flex flex-col items-center justify-center py-20\">\n          <div class=\"animate-spin rounded-full h-10 w-10 border-b-2 border-primary_button_color mb-4\"></div>\n          <p class=\"text-sm text-text_color\">Loading payment form...</p>\n        </div>\n\n        <div v-show=\"!isLoading\" id=\"payment-element\" class=\"mb-6\">\n        </div>\n\n        <button\n          v-show=\"!isLoading\"\n          id=\"submit\"\n          type=\"submit\"\n          :disabled=\"isProcessing\"\n          class=\"w-full btn\"\n          :class=\"isProcessing ? 'btn--disabled' : 'btn--primary'\"\n        >\n          <div v-if=\"isProcessing\" class=\"flex items-center justify-center gap-2\">\n            <div class=\"spinner w-5 h-5 border-2 border-background_color border-t-transparent rounded-full animate-spin\"></div>\n            <span class=\"btn__text\">Processing...</span>\n          </div>\n          <span v-else class=\"btn__text\">Pay €{{ amount }}</span>\n          <span class=\"btn__fill\"></span>\n        </button>\n\n        <div v-if=\"errorMessage\" id=\"payment-message\" class=\"mt-4 p-4 bg-error_text_color/10 border border-error_text_color rounded\">\n          <div class=\"flex items-start gap-2\">\n            <svg class=\"w-5 h-5 text-error_text_color flex-shrink-0 mt-0.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path fill-rule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clip-rule=\"evenodd\" />\n            </svg>\n            <p class=\"text-sm text-error_text_color\">{{ errorMessage }}</p>\n          </div>\n        </div>\n      </form>\n\n      <div class=\"text-center space-y-2\">\n        <div class=\"flex items-center justify-center gap-2 text-success_text_color\">\n          <svg class=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n            <path fill-rule=\"evenodd\" d=\"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z\" clip-rule=\"evenodd\" />\n          </svg>\n          <p class=\"text-sm text-text_color font-medium\">Secure payment powered by Stripe</p>\n        </div>\n        <p class=\"text-xs text-text_color\">All transactions are encrypted and secure</p>\n      </div>\n    </div>\n  </section>\n</template>"],"names":["_ssrRenderAttrs","_mergeProps","_ssrRenderComponent","_unref"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,UAAM,QAAQ,SAAA;AAEO,aAAS,MAAM,MAAM,MAAM,YAAsB;AACtE,UAAM,iBAAiB,SAAS,MAAM,MAAM,MAAM,GAAa;AAC/D,UAAM,SAAS,SAAS,MAAM,MAAM,MAAM,MAAgB;AAE1D,UAAM,eAAe,IAAI,KAAK;AAC9B,UAAM,eAAe,IAAI,EAAE;AAC3B,UAAM,YAAY,IAAI,IAAI;;;AAgHf,YAAA,WAAAA,eAAAC,WAAA,EAAA,OAAM,sCAAkC,MAAA,CAAA,CAAA,GAAA;AAC/B,YAAAC,mBAAA,0BAAA,EAAA,MAAM,SAAK,MAAA,OAAA,CAAA;gOAMyBC,MAAA,cAAA,CAAc,qVAQHA,MAAA,MAAA,CAAM;UAItDA,MAAA,SAAA,GAAS;;;;;6EAKNA,MAAA,SAAA,IAAS,OAAA,EAAA,SAAA,QAAA,mEAOVA,MAAA,YAAA,CAAY,IAAA,cAAA,6BAEfA,MAAA,YAAA,IAAY,kBAAA,gBAAA,YAAA,CAAA,6BALXA,MAAA,SAAA,IAAS,OAAA,EAAA,SAAA,OAAA,CAAA;UAOPA,MAAA,YAAA,GAAY;;;6DAIgBA,MAAA,MAAA,CAAM,CAAA,SAAA;AAAA;;UAIpCA,MAAA,YAAA,GAAY;qlBAKyBA,MAAA,YAAA,CAAY,CAAA,kBAAA;AAAA;;;;;;;;;;;;;"}