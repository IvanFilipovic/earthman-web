import{createRenderer as e,getRequestDependencies as t,getPreloadLinks as r,getPrefetchLinks as n}from"file:///home/user/earthman-web/node_modules/vue-bundle-renderer/dist/runtime.mjs";import{getResponseStatusText as o,getResponseStatus as s,getQuery as a,createError as i,appendResponseHeader as d}from"file:///home/user/earthman-web/node_modules/h3/dist/index.mjs";import{b as l,c as u,f as p,a as c,g as h,h as m,i as f,p as y,j as b,k as g,l as w,m as _,n as j,w as x,o as v,q as C}from"../nitro/nitro.mjs";import{renderToString as S}from"file:///home/user/earthman-web/node_modules/vue/server-renderer/index.mjs";import{createHead as R,propsToString as T,renderSSRHead as A}from"file:///home/user/earthman-web/node_modules/unhead/dist/server.mjs";import{stringify as P,uneval as $}from"file:///home/user/earthman-web/node_modules/devalue/index.js";import{FlatMetaPlugin as k,DeprecationsPlugin as H,PromisesPlugin as L,TemplateParamsPlugin as M,AliasSortingPlugin as U}from"file:///home/user/earthman-web/node_modules/unhead/dist/plugins.mjs";import{walkResolver as O}from"file:///home/user/earthman-web/node_modules/unhead/dist/utils.mjs";import{toValue as z,isRef as I,hasInjectionContext as N,inject as E,ref as F,watchEffect as D,getCurrentInstance as q,onBeforeUnmount as J,onDeactivated as X,onActivated as B}from"file:///home/user/earthman-web/node_modules/vue/index.mjs";import{relative as G}from"file:///home/user/earthman-web/node_modules/pathe/dist/index.mjs";const VueResolver=(e,t)=>I(t)?z(t):t,W="usehead";function injectHead(){if(N()){const e=E(W);if(!e)throw new Error("useHead() was called without provide context, ensure you call it through the setup() function.");return e}throw new Error("useHead() was called without provide context, ensure you call it through the setup() function.")}function useHead(e,t={}){const r=t.head||injectHead();return r.ssr?r.push(e||{},t):function(e,t,r={}){const n=F(!1);let o;D(()=>{const s=n.value?{}:O(t,VueResolver);o?o.patch(s):o=e.push(s,r)});q()&&(J(()=>{o.dispose()}),X(()=>{n.value=!0}),B(()=>{n.value=!1}));return o}(r,e,t)}function useSeoMeta(e={},t={}){(t.head||injectHead()).use(k);const{title:r,titleTemplate:n,...o}=e;return useHead({title:r,titleTemplate:n,_flatMeta:o},t)}function createHead(e={}){const t=R({...e,propResolvers:[VueResolver]});return t.install=function(e){return{install(t){t.config.globalProperties.$unhead=e,t.config.globalProperties.$head=e,t.provide(W,e)}}.install}(t),t}const Y=`<${u}${T(p)}>`,K=`</${u}>`,getClientManifest=()=>import("../build/client.manifest.mjs").then(e=>e.default||e).then(e=>"function"==typeof e?e():e),Q=lazyCachedFunction(async()=>{const t=await getClientManifest();if(!t)throw new Error("client.manifest is not available");const r=await import("../build/server.mjs").then(e=>e.default||e);if(!r)throw new Error("Server bundle is not available");return e(r,{manifest:t,renderToString:async function(e,t){const r=await S(e,t);return Y+r+K},buildAssetsURL:l})}),V=lazyCachedFunction(async()=>{const t=await getClientManifest(),r=await import("../virtual/_virtual_spa-template.mjs").then(e=>e.template).catch(()=>"").then(e=>Y+e+K),n=e(()=>()=>{},{manifest:t,renderToString:()=>r,buildAssetsURL:l}),o=await n.renderToString({});return{rendererContext:n.rendererContext,renderToString:e=>{const t=c(e.event);return e.modules||=new Set,e.payload.serverRendered=!1,e.config={public:t.public,app:t.app},Promise.resolve(o)}}});function lazyCachedFunction(e){let t=null;return()=>(null===t&&(t=e().catch(e=>{throw t=null,e})),t)}const Z=lazyCachedFunction(()=>import("../build/styles.mjs").then(e=>e.default||e)),ee=h("internal:nuxt:prerender:payload");function renderPayloadResponse(e){return{body:P(splitPayload(e).payload,e._payloadReducers),statusCode:s(e.event),statusMessage:o(e.event),headers:{"content-type":"application/json;charset=utf-8","x-powered-by":"Nuxt"}}}function renderPayloadJsonScript(e){const t={type:"application/json",innerHTML:e.data?P(e.data,e.ssrContext._payloadReducers):"","data-nuxt-data":m,"data-ssr":!e.ssrContext.noSSR,id:"__NUXT_DATA__"};e.src&&(t["data-src"]=e.src);return[t,{innerHTML:`window.__NUXT__={};window.__NUXT__.config=${$(e.ssrContext.config)}`}]}function splitPayload(e){const{data:t,prerenderedAt:r,...n}=e.payload;return{initial:{...n,prerenderedAt:r},payload:{data:t,prerenderedAt:r}}}h("internal:nuxt:prerender:island"),h("internal:nuxt:prerender:island-props");const te={disableDefaults:!0,disableCapoSorting:!1,plugins:[H,L,M,U]},re=new Set(["/index.html","/200.html","/404.html"]);const ne={omitLineBreaks:!1};globalThis.__buildAssetsURL=l,globalThis.__publicAssetsURL=y;const oe=!!g.id,se=oe?`<${b}${T(g)}>`:"",ae=oe?`</${b}>`:"",ie=/^[^?]*\/_payload.json(?:\?.*)?$/,de="_payload.json";let le;const ue=f(async e=>{const u=C(),p=e.path.startsWith("/__nuxt_error")?a(e):null;if(p&&!("__unenv__"in e.node.req))throw i({statusCode:404,statusMessage:"Page Not Found: /__nuxt_error"});const h=function(e){const t={url:e.path,event:e,runtimeConfig:c(e),noSSR:e.context.nuxt?.noSSR||re.has(e.path),head:createHead(te),error:!1,nuxt:void 0,payload:{},_payloadReducers:Object.create(null),modules:new Set};return t.payload.prerenderedAt=Date.now(),t}(e),m={mode:"server"};h.head.push(w,m),p&&(p.statusCode&&=Number.parseInt(p.statusCode),function(e,t){e.error=!0,e.payload={error:t},e.url=t.url}(h,p));const f=ie.test(h.url);if(f){const t=h.url.substring(0,h.url.lastIndexOf("/"))||"/";if(h.url=t,e._path=e.node.req.url=t,await ee.hasItem(t))return ee.getItem(t)}const y=_(e);!1===y.ssr&&(h.noSSR=!0);const b=!h.noSSR,S=b?j(h.runtimeConfig.app.cdnURL||h.runtimeConfig.app.baseURL,h.url.replace(/\?.*$/,""),de)+"?"+h.runtimeConfig.app.buildId:void 0,R=await function(e){return e.noSSR?V():Q()}(h);for(const e of await getClientManifest().then(e=>{const t=[];for(const r of Object.values(e))r._globalCSS&&t.push(r.src);return t}))h.modules.add(e);const T=await R.renderToString(h).catch(async e=>{if(h._renderResponse&&"skipping render"===e.message)return{};const t=!p&&h.payload?.error||e;throw await(h.nuxt?.hooks.callHook("app:error",t)),t}),P=h._renderResponse||f?[]:await async function(e){const t=await Z(),r=new Set;for(const n of e)if(n in t&&t[n])for(const e of await t[n]())r.add(e);return Array.from(r).map(e=>({innerHTML:e}))}(h.modules??[]);if(await(h.nuxt?.hooks.callHook("app:rendered",{ssrContext:h,renderResult:T})),h._renderResponse)return h._renderResponse;if(h.payload?.error&&!p)throw h.payload.error;if(f){const e=renderPayloadResponse(h);return await ee.setItem(h.url,e),e}b&&(d(e,"x-nitro-prerender",j(h.url.replace(/\?.*$/,""),de)),await ee.setItem(x(h.url),renderPayloadResponse(h)));const $=y.noScripts,{styles:k,scripts:H}=t(h,R.rendererContext);if(!$){let t=le;t||(t=l("CGpS8kLM.js"),/^(?:\/|\.+\/)/.test(t)||v(t,{acceptRelative:!0})?le=t:(t=G(e.path.replace(/\/[^/]+$/,"/"),j("/",t)),/^(?:\/|\.+\/)/.test(t)||(t=`./${t}`))),h.head.push({script:[{tagPosition:"head",tagPriority:-2,type:"importmap",innerHTML:JSON.stringify({imports:{"#entry":t}})}]},m)}b&&!$&&h.head.push({link:[{rel:"preload",as:"fetch",crossorigin:"anonymous",href:S}]},m),h._preloadManifest&&!$&&h.head.push({link:[{rel:"preload",as:"fetch",fetchpriority:"low",crossorigin:"anonymous",href:l(`builds/meta/${h.runtimeConfig.app.buildId}.json`)}]},{...m,tagPriority:"low"}),P.length&&h.head.push({style:P});const L=[];for(const e of Object.values(k))L.push({rel:"stylesheet",href:R.rendererContext.buildAssetsURL(e.file),crossorigin:""});if(L.length&&h.head.push({link:L},m),$||(h.head.push({link:r(h,R.rendererContext)},m),h.head.push({link:n(h,R.rendererContext)},m),h.head.push({script:renderPayloadJsonScript(b?{ssrContext:h,data:splitPayload(h).initial,src:S}:{ssrContext:h,data:h.payload})},{...m,tagPosition:"bodyClose",tagPriority:"high"})),!y.noScripts){const e="head";h.head.push({script:Object.values(H).map(t=>({type:t.module?"module":null,src:R.rendererContext.buildAssetsURL(t.file),defer:!t.module||null,tagPosition:e,crossorigin:""}))},m)}const{headTags:M,bodyTags:U,bodyTagsOpen:O,htmlAttrs:z,bodyAttrs:I}=await A(h.head,ne),N={htmlAttrs:z?[z]:[],head:normalizeChunks([M]),bodyAttrs:I?[I]:[],bodyPrepend:normalizeChunks([O,h.teleports?.body]),body:[T.html,se+(oe?joinTags([h.teleports?.[`#${g.id}`]]):"")+ae],bodyAppend:[U]};return await u.hooks.callHook("render:html",N,{event:e}),{body:(E=N,`<!DOCTYPE html><html${joinAttrs(E.htmlAttrs)}><head>${joinTags(E.head)}</head><body${joinAttrs(E.bodyAttrs)}>${joinTags(E.bodyPrepend)}${joinTags(E.body)}${joinTags(E.bodyAppend)}</body></html>`),statusCode:s(e),statusMessage:o(e),headers:{"content-type":"text/html;charset=utf-8","x-powered-by":"Nuxt"}};var E});function normalizeChunks(e){const t=[];for(const r of e){const e=r?.trim();e&&t.push(e)}return t}function joinTags(e){return e.join("")}function joinAttrs(e){return 0===e.length?"":" "+e.join(" ")}const pe=Object.freeze(Object.defineProperty({__proto__:null,default:ue},Symbol.toStringTag,{value:"Module"}));export{useHead as a,W as h,pe as r,useSeoMeta as u};
//# sourceMappingURL=renderer.mjs.map
