import{defineComponent as e,computed as o,h as t,onServerPrefetch as a,toValue as s,getCurrentInstance as i,ref as n,shallowRef as r,toRef as l,nextTick as u,unref as d}from"file:///home/kai/Projekti/webshop/node_modules/vue/index.mjs";import{Icon as c,getIcon as m,loadIcon as p}from"file:///home/kai/Projekti/webshop/node_modules/@iconify/vue/dist/iconify.mjs";import{getIconCSS as f}from"file:///home/kai/Projekti/webshop/node_modules/@iconify/utils/lib/css/icon.mjs";import{k as h,x as v,e as y,u as _,t as k,v as j}from"./server.mjs";import{debounce as P}from"file:///home/kai/Projekti/webshop/node_modules/nuxt/node_modules/perfect-debounce/dist/index.mjs";import"file:///home/kai/Projekti/webshop/node_modules/ofetch/dist/node.mjs";import"../nitro/nitro.mjs";import"file:///home/kai/Projekti/webshop/node_modules/h3/dist/index.mjs";import"file:///home/kai/Projekti/webshop/node_modules/destr/dist/index.mjs";import"file:///home/kai/Projekti/webshop/node_modules/hookable/dist/index.mjs";import"file:///home/kai/Projekti/webshop/node_modules/node-mock-http/dist/index.mjs";import"file:///home/kai/Projekti/webshop/node_modules/unstorage/dist/index.mjs";import"file:///home/kai/Projekti/webshop/node_modules/unstorage/drivers/fs.mjs";import"file:///home/kai/Projekti/webshop/node_modules/unstorage/drivers/fs-lite.mjs";import"file:///home/kai/Projekti/webshop/node_modules/unstorage/drivers/lru-cache.mjs";import"file:///home/kai/Projekti/webshop/node_modules/ohash/dist/index.mjs";import"file:///home/kai/Projekti/webshop/node_modules/klona/dist/index.mjs";import"file:///home/kai/Projekti/webshop/node_modules/defu/dist/defu.mjs";import"file:///home/kai/Projekti/webshop/node_modules/scule/dist/index.mjs";import"file:///home/kai/Projekti/webshop/node_modules/unctx/dist/index.mjs";import"file:///home/kai/Projekti/webshop/node_modules/radix3/dist/index.mjs";import"file:///home/kai/Projekti/webshop/node_modules/@intlify/utils/dist/index.mjs";import"file:///home/kai/Projekti/webshop/node_modules/cookie-es/dist/index.mjs";import"file:///home/kai/Projekti/webshop/node_modules/vue-router/dist/vue-router.node.mjs";import"node:fs";import"node:url";import"file:///home/kai/Projekti/webshop/node_modules/pathe/dist/index.mjs";import"file:///home/kai/Projekti/webshop/node_modules/@iconify/utils/lib/index.mjs";import"file:///home/kai/Projekti/webshop/node_modules/consola/dist/index.mjs";import"file:///home/kai/Projekti/webshop/node_modules/ipx/dist/index.mjs";import"file:///home/kai/Projekti/webshop/node_modules/pinia/dist/pinia.prod.cjs";import"file:///home/kai/Projekti/webshop/node_modules/vue-devtools-stub/dist/index.mjs";import"file:///home/kai/Projekti/webshop/node_modules/vue/server-renderer/index.mjs";import"../_/renderer.mjs";import"file:///home/kai/Projekti/webshop/node_modules/vue-bundle-renderer/dist/runtime.mjs";import"file:///home/kai/Projekti/webshop/node_modules/unhead/dist/server.mjs";import"file:///home/kai/Projekti/webshop/node_modules/devalue/index.js";import"file:///home/kai/Projekti/webshop/node_modules/unhead/dist/utils.mjs";import"file:///home/kai/Projekti/webshop/node_modules/unhead/dist/plugins.mjs";function useAsyncData(...e){var t;const c="string"==typeof e[e.length-1]?e.pop():void 0;(function(e,o){if("string"==typeof e)return!1;if("object"==typeof e&&null!==e)return!1;if("function"==typeof e&&"function"==typeof o)return!1;return!0})(e[0],e[1])&&e.unshift(c);let[m,p,f={}]=e;const v=o(()=>s(m));if("string"!=typeof v.value)throw new TypeError("[nuxt] [useAsyncData] key must be a string.");if("function"!=typeof p)throw new TypeError("[nuxt] [useAsyncData] handler must be a function.");const y=h();null!=f.server||(f.server=!0),null!=f.default||(f.default=getDefault),null!=f.getCachedData||(f.getCachedData=getDefaultCachedData),null!=f.lazy||(f.lazy=!1),null!=f.immediate||(f.immediate=!0),null!=f.deep||(f.deep=k.deep),null!=f.dedupe||(f.dedupe="cancel"),f._functionName,y._asyncData[v.value];const _={cause:"initial",dedupe:f.dedupe};(null==(t=y._asyncData[v.value])?void 0:t._init)||(_.cachedData=f.getCachedData(v.value,y,{cause:"initial"}),y._asyncData[v.value]=function(e,o,t,a,s){var i,c;null!=(i=e.payload._errors)[o]||(i[o]=k.errorValue);const m=a.getCachedData!==getDefaultCachedData,p=(null==(c=e.ssrContext)?void 0:c._sharedPrerenderCache)?()=>{const a=e.ssrContext._sharedPrerenderCache.get(o);if(a)return a;const s=Promise.resolve().then(()=>e.runWithContext(()=>t(e)));return e.ssrContext._sharedPrerenderCache.set(o,s),s}:t,f=a.deep?n:r,h=null!=s,v=e.hook("app:data:refresh",async e=>{e&&!e.includes(o)||await y.execute({cause:"refresh:hook"})}),y={data:f(h?s:a.default()),pending:r(!h),error:l(e.payload._errors,o),status:r("idle"),execute:(...t)=>{var s,i;const[n,r]=t,l=n&&void 0===r&&"object"==typeof n?n:{};if(e._asyncDataPromises[o]){if("defer"===(u=null!=(s=l.dedupe)?s:a.dedupe)||!1===u)return e._asyncDataPromises[o];e._asyncDataPromises[o].cancelled=!0}var u;if("initial"===l.cause||e.isHydrating){const t="cachedData"in l?l.cachedData:a.getCachedData(o,e,{cause:null!=(i=l.cause)?i:"refresh:manual"});if(null!=t)return e.payload.data[o]=y.data.value=t,y.error.value=k.errorValue,y.status.value="success",Promise.resolve(t)}y.pending.value=!0,y.status.value="pending";const c=new Promise((o,t)=>{try{o(p(e))}catch(e){t(e)}}).then(async t=>{if(c.cancelled)return e._asyncDataPromises[o];let s=t;a.transform&&(s=await a.transform(t)),a.pick&&(s=function(e,o){const t={};for(const a of o)t[a]=e[a];return t}(s,a.pick)),e.payload.data[o]=s,y.data.value=s,y.error.value=k.errorValue,y.status.value="success"}).catch(t=>{if(c.cancelled)return e._asyncDataPromises[o];y.error.value=j(t),y.data.value=d(a.default()),y.status.value="error"}).finally(()=>{c.cancelled||(y.pending.value=!1,delete e._asyncDataPromises[o])});return e._asyncDataPromises[o]=c,e._asyncDataPromises[o]},_execute:P((...e)=>y.execute(...e),0,{leading:!0}),_default:a.default,_deps:0,_init:!0,_hash:void 0,_off:()=>{var t;v(),(null==(t=e._asyncData[o])?void 0:t._init)&&(e._asyncData[o]._init=!1),m||u(()=>{var t;(null==(t=e._asyncData[o])?void 0:t._init)||(clearNuxtDataByKey(e,o),y.execute=()=>Promise.resolve(),y.data.value=k.value)})}};return y}(y,v.value,p,f,_.cachedData));y._asyncData[v.value]._deps++;if(!1!==f.server&&y.payload.serverRendered&&f.immediate){const e=y._asyncData[v.value].execute(_);i()?a(()=>e):y.hook("app:created",async()=>{await e})}const w={data:writableComputedRef(()=>{var e;return null==(e=y._asyncData[v.value])?void 0:e.data}),pending:writableComputedRef(()=>{var e;return null==(e=y._asyncData[v.value])?void 0:e.pending}),status:writableComputedRef(()=>{var e;return null==(e=y._asyncData[v.value])?void 0:e.status}),error:writableComputedRef(()=>{var e;return null==(e=y._asyncData[v.value])?void 0:e.error}),refresh:(...e)=>y._asyncData[v.value].execute(...e),execute:(...e)=>y._asyncData[v.value].execute(...e),clear:()=>clearNuxtDataByKey(y,v.value)},b=Promise.resolve(y._asyncDataPromises[v.value]).then(()=>w);return Object.assign(b,w),b}function writableComputedRef(e){return o({get(){var o;return null==(o=e())?void 0:o.value},set(o){const t=e();t&&(t.value=o)}})}function clearNuxtDataByKey(e,o){o in e.payload.data&&(e.payload.data[o]=void 0),o in e.payload._errors&&(e.payload._errors[o]=k.errorValue),e._asyncData[o]&&(e._asyncData[o].data.value=void 0,e._asyncData[o].error.value=k.errorValue,e._asyncData[o].pending.value=!1,e._asyncData[o].status.value="idle"),o in e._asyncDataPromises&&(e._asyncDataPromises[o]&&(e._asyncDataPromises[o].cancelled=!0),e._asyncDataPromises[o]=void 0)}const getDefault=()=>k.value,getDefaultCachedData=(e,o,t)=>o.isHydrating?o.payload.data[e]:"refresh:manual"!==t.cause&&"refresh:hook"!==t.cause?o.static.data[e]:void 0;async function loadIcon(e,o){if(!e)return null;const t=m(e);if(t)return t;let a;const s=p(e).catch(()=>(console.warn(`[Icon] failed to load icon \`${e}\``),null));return o>0?await Promise.race([s,new Promise(t=>{a=setTimeout(()=>{console.warn(`[Icon] loading icon \`${e}\` timed out after ${o}ms`),t()},o)})]).finally(()=>clearTimeout(a)):await s,m(e)}function useResolvedName(e){const t=v().icon,a=(t.collections||[]).sort((e,o)=>o.length-e.length);return o(()=>{var o;const s=e(),i=s.startsWith(t.cssSelectorPrefix)?s.slice(t.cssSelectorPrefix.length):s,n=(null==(o=t.aliases)?void 0:o[i])||i;if(!n.includes(":")){const e=a.find(e=>n.startsWith(e+"-"));return e?e+":"+n.slice(e.length+1):n}return n})}function resolveCustomizeFn(e,o){if(!1!==e)return!0===e||null===e?o:e}const w="NUXT_ICONS_SERVER_CSS";const b=e({name:"NuxtIconCss",props:{name:{type:String,required:!0},customize:{type:[Function,Boolean,null],default:null,required:!1}},setup(e){const s=h(),i=v().icon,n=o(()=>e.name?i.cssSelectorPrefix+e.name:""),r=o(()=>"."+function(e){return e.replace(/([^\w-])/g,"\\$1")}(n.value));return a(async()=>{var o;{const t=y().icon||{};if(!(null==(o=null==t?void 0:t.serverKnownCssClasses)?void 0:o.includes(n.value))){const o=await loadIcon(e.name,i.fetchTimeout).catch(()=>null);if(!o)return null;let t=s.vueApp._context.provides[w];if(t||(t=s.vueApp._context.provides[w]=new Map,s.runWithContext(()=>{_({style:[()=>{let e=Array.from(t.values()).sort().join("");return i.cssLayer&&(e=`@layer ${i.cssLayer} {${e}}`),{innerHTML:e}}]},{tagPriority:"low"})})),e.name&&!t.has(e.name)){const a=function(o,t=!0){let a=r.value;i.cssWherePseudo&&(a=`:where(${a})`);const s=f(o,{iconSelector:a,format:"compressed",customise:resolveCustomizeFn(e.customize,i.customize)});return i.cssLayer&&t?`@layer ${i.cssLayer} { ${s} }`:s}(o,!1);t.set(e.name,a)}return null}}}),()=>t("span",{class:["iconify",n.value]})}}),x=e({name:"NuxtIconSvg",props:{name:{type:String,required:!0},customize:{type:[Function,Boolean,null],default:null,required:!1}},setup(e,{slots:o}){h();const s=v().icon,i=useResolvedName(()=>e.name),n="i-"+i.value;return i.value&&a(async()=>{await useAsyncData(n,async()=>await loadIcon(i.value,s.fetchTimeout),{deep:!1})}),()=>t(c,{icon:i.value,ssr:!0,customise:resolveCustomizeFn(e.customize,s.customize)},o)}}),D=e({name:"NuxtIcon",props:{name:{type:String,required:!0},mode:{type:String,required:!1,default:null},size:{type:[Number,String],required:!1,default:null},customize:{type:[Function,Boolean,null],default:null,required:!1}},setup(e,{slots:a}){const s=h(),i=v().icon,n=useResolvedName(()=>e.name),r=o(()=>{var o;return(null==(o=s.vueApp)?void 0:o.component(n.value))||("svg"===(e.mode||i.mode)?x:b)}),l=o(()=>{const o=e.size||i.size;return o?{fontSize:Number.isNaN(+o)?o:o+"px"}:null});return()=>t(r.value,{...i.attrs,name:n.value,class:i.class,style:l.value,customize:e.customize},a)}}),g=Object.freeze(Object.defineProperty({__proto__:null,default:D},Symbol.toStringTag,{value:"Module"}));export{D as _,g as i,useAsyncData as u};
//# sourceMappingURL=index-Ccr6sSLn.mjs.map
