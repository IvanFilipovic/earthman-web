import{defineEventHandler as e,readBody as o,createError as s}from"file:///home/user/earthman-web/node_modules/h3/dist/index.mjs";import{u as t,a as m}from"../../nitro/nitro.mjs";import"file:///home/user/earthman-web/node_modules/nodemailer/lib/nodemailer.js";import"node:crypto";import"file:///home/user/earthman-web/node_modules/destr/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/hookable/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/ofetch/dist/node.mjs";import"file:///home/user/earthman-web/node_modules/node-mock-http/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/unstorage/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/unstorage/drivers/fs.mjs";import"file:///home/user/earthman-web/node_modules/unstorage/drivers/fs-lite.mjs";import"file:///home/user/earthman-web/node_modules/unstorage/drivers/lru-cache.mjs";import"file:///home/user/earthman-web/node_modules/ohash/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/klona/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/defu/dist/defu.mjs";import"file:///home/user/earthman-web/node_modules/scule/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/unctx/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/radix3/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/@intlify/utils/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/cookie-es/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/vue-router/dist/vue-router.node.mjs";import"node:fs";import"node:url";import"file:///home/user/earthman-web/node_modules/pathe/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/@iconify/utils/lib/index.mjs";import"file:///home/user/earthman-web/node_modules/consola/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/ipx/dist/index.mjs";const i=e(async e=>{const{sendMail:i}=t(),r=m();console.log("ğŸ” Runtime Config:",{contactEmailRecipient:r.contactEmailRecipient,hasRecipient:!!r.contactEmailRecipient});const n=await o(e),{name:a,email:d,subject:l,message:u}=n;if(!(a&&d&&l&&u))throw s({statusCode:400,statusMessage:"All fields are required"});const h=r.contactEmailRecipient;if(console.log("ğŸ“§ Recipient email:",h),!h)throw console.error("âŒ CRITICAL: No recipient email configured!"),s({statusCode:500,statusMessage:"Server configuration error: No recipient email"});try{return console.log("ğŸ“¨ Attempting to send to:",h),await i({from:'"Earthman Contact" <noreply@earthman.com>',to:h,replyTo:d,subject:`[Earthman Contact] ${l}`,text:`From: ${a}\nEmail: ${d}\n\n${u}`}),console.log("âœ… Email sent successfully"),{success:!0}}catch(e){throw console.error("âŒ Contact form error:",e.message),s({statusCode:500,statusMessage:e.message})}});export{i as default};
//# sourceMappingURL=contact.post.mjs.map
