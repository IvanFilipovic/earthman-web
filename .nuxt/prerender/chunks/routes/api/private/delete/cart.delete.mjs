import{a as e}from"../../../../nitro/nitro.mjs";import{defineEventHandler as o,getCookie as s,getQuery as t,readBody as m,createError as i}from"file:///home/user/earthman-web/node_modules/h3/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/nodemailer/lib/nodemailer.js";import"node:crypto";import"file:///home/user/earthman-web/node_modules/destr/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/hookable/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/ofetch/dist/node.mjs";import"file:///home/user/earthman-web/node_modules/node-mock-http/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/unstorage/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/unstorage/drivers/fs.mjs";import"file:///home/user/earthman-web/node_modules/unstorage/drivers/fs-lite.mjs";import"file:///home/user/earthman-web/node_modules/unstorage/drivers/lru-cache.mjs";import"file:///home/user/earthman-web/node_modules/ohash/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/klona/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/defu/dist/defu.mjs";import"file:///home/user/earthman-web/node_modules/scule/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/unctx/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/radix3/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/@intlify/utils/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/cookie-es/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/vue-router/dist/vue-router.node.mjs";import"node:fs";import"node:url";import"file:///home/user/earthman-web/node_modules/pathe/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/@iconify/utils/lib/index.mjs";import"file:///home/user/earthman-web/node_modules/consola/dist/index.mjs";import"file:///home/user/earthman-web/node_modules/ipx/dist/index.mjs";const r=o(async o=>{const{apiBase:r,cartSessionCookie:d}=e().public,n=d||"cart_session_id";let a=s(o,n)||"none";const u=`${n}=${encodeURIComponent(a)}`;let l=t(o).product_slug;if(!l)try{const e=await m(o);l=null==e?void 0:e.product_slug}catch(e){}if(!l)throw i({statusCode:400,statusMessage:"Missing product_slug"});try{return await $fetch(`${r}/public/cart/item/delete/`,{method:"DELETE",headers:{"Content-Type":"application/json",cookie:u},body:{product_variant_slug:l}})}catch(e){throw console.error("‚ùå DELETE /cart - Django error:",e),i({statusCode:(null==e?void 0:e.status)||500,statusMessage:(null==e?void 0:e.statusText)||"Delete failed",data:(null==e?void 0:e.data)||null})}});export{r as default};
//# sourceMappingURL=cart.delete.mjs.map
