import{_ as t}from"./nuxt-link-7pp3EPK3.mjs";import{_ as a,c as e,d as s}from"./server.mjs";import{_ as o}from"./index-qGNUStbk.mjs";import{defineComponent as i,ref as l,computed as n,watch as c,withCtx as r,createVNode as d,unref as u,createTextVNode as f,useSSRContext as h}from"vue";import{ssrRenderAttrs as m,ssrRenderComponent as p,ssrRenderAttr as v}from"vue/server-renderer";import{p as g}from"../nitro/nitro.mjs";import{defineStore as y}from"pinia";const x=g("/logo/earth-man920.png"),_=y("cart",{state:()=>({items:[],totals:{toPay:"0.00"},loading:!1,lastFetched:null}),getters:{itemCount:t=>t.items.reduce((t,a)=>t+a.quantity,0),getVariantQuantity:t=>a=>{const e=t.items.find(t=>t.product_slug===a||t.product_variant_slug===a);return(null==e?void 0:e.quantity)||0},merchandiseTotal:t=>t.items.reduce((t,a)=>t+parseFloat(a.unit_price_discounted||a.unit_price_original)*a.quantity,0),hasItems:t=>t.items.length>0},actions:{async fetchCart(t=!1){const a=Date.now();if(!(!t&&this.lastFetched&&a-this.lastFetched<3e4)){this.loading=!0;try{const t=await $fetch("/api/private/get/cart");this.items=(null==t?void 0:t.items)||[],this.totals={toPay:(null==t?void 0:t.cart_total_to_pay)||"0.00"},this.lastFetched=a}catch(t){console.error("Failed to fetch cart:",t),this.items=[],this.totals={toPay:"0.00"}}finally{this.loading=!1}}},async addToCart(t,a){const e=this.getVariantQuantity(t)+a,s=this.items.find(a=>a.product_slug===t||a.product_variant_slug===t),o=(null==s?void 0:s.quantity)||0;s&&(s.quantity=e);const i=this.merchandiseTotal.toFixed(2);this.totals.toPay=i;try{await $fetch("/api/private/put/cart",{method:"PUT",headers:{"Content-Type":"application/json"},body:{product_slug:t,quantity:e}})}catch(a){if(s)if(o>0)s.quantity=o;else{const a=this.items.findIndex(a=>a.product_slug===t||a.product_variant_slug===t);a>-1&&this.items.splice(a,1)}const e=this.merchandiseTotal.toFixed(2);throw this.totals.toPay=e,a}},async removeFromCart(t){const a=t.product_slug||t.product_variant_slug;if(!a)return void console.error("No slug found in item:",t);const e=this.items.findIndex(t=>t.product_slug===a||t.product_variant_slug===a);if(-1===e)return;const s=this.items.splice(e,1)[0];console.log("ðŸš€ removeFromCart - Removing:",a);try{await $fetch(`/api/private/delete/cart?product_slug=${encodeURIComponent(a)}`,{method:"DELETE"}),console.log("âœ… removeFromCart - Success");const t=this.merchandiseTotal.toFixed(2);this.totals.toPay=t}catch(t){throw console.error("âŒ removeFromCart - Error:",t),this.items.splice(e,0,s),t}},async updateQuantity(t,a){const e=this.items.find(a=>a.product_slug===t||a.product_variant_slug===t);if(!e)return;const s=e.quantity;e.quantity=a;const o=this.merchandiseTotal.toFixed(2);this.totals.toPay=o;try{await $fetch("/api/private/put/cart",{method:"PUT",headers:{"Content-Type":"application/json"},body:{product_slug:t,quantity:a}})}catch(t){e.quantity=s;const a=this.merchandiseTotal.toFixed(2);throw this.totals.toPay=a,t}},clearCache(){this.lastFetched=null},async clearCart(){const t=[...this.items],a={...this.totals};this.items=[],this.totals={toPay:"0.00"};try{await $fetch("/api/private/cart/clear",{method:"DELETE"})}catch(e){throw this.items=t,this.totals=a,e}}}}),w=i({__name:"AppNavigation",__ssrInlineRender:!0,props:{dark:{type:Boolean,default:!1}},setup(a){const i=a,h=e();_();const g=l(!1),y=l(!1),w=n(()=>i.dark?"text-background_color":"text-text_color");function getNavWeight(t){return function(t){return h.path===t||h.path.startsWith(`${t}/`)}(t)?"font-bold":"font-light"}return c(g,t=>{}),c(y,t=>{}),(a,e,i,l)=>{const n=t,c=s,h=o;e(`<section${m(l)} data-v-62f73fcd><div class="hidden md:flex flex-col lg:flex-row w-full z-50" data-v-62f73fcd><div class="flex flex-col w-full lg:w-1/2 h-full" data-v-62f73fcd><div class="absolute inset-x-0 top-0 w-1/2 h-full md:px-8" data-v-62f73fcd>`),e(p(n,{to:"/",class:"flex justify-center py-6"},{default:r((t,a,e,s)=>{if(!a)return[d("img",{src:x,alt:"Earth Man Logo",class:"max-w-[100%] h-auto object-contain"})];a(`<img${v("src",x)} alt="Earth Man Logo" class="max-w-[100%] h-auto object-contain" data-v-62f73fcd${s}>`)}),_:1},i)),e('</div></div><div class="hidden md:flex w-full items-start justify-end lg:w-1/2 px-4 md:px-8 md:py-14 lg:py-24 gap-6 h-full" data-v-62f73fcd><section class="flex flex-col justify-end w-full bg-transparent z-50 my-auto" data-v-62f73fcd><div class="flex pt-4" data-v-62f73fcd><div class="flex flex-row justify-end w-full mx-auto space-x-4 py-4" data-v-62f73fcd>'),e(p(n,{to:"/shop",class:[u(w),getNavWeight("/shop"),"text-sm my-auto px-4"]},{default:r((t,a,e,s)=>{if(!a)return[f(" SHOP ")];a(" SHOP ")}),_:1},i)),e(p(n,{to:"/collections",class:[u(w),getNavWeight("/collections"),"text-sm my-auto px-4"]},{default:r((t,a,e,s)=>{if(!a)return[f(" STORIES ")];a(" STORIES ")}),_:1},i)),e(p(n,{to:"/about",class:[u(w),getNavWeight("/about"),"text-sm my-auto px-4"]},{default:r((t,a,e,s)=>{if(!a)return[f(" ABOUT ")];a(" ABOUT ")}),_:1},i)),e(p(c,null,{},i)),e(p(n,{to:"/profile",class:[u(w),getNavWeight("/profile"),"my-auto font-light pl-4"],"aria-label":"User profile"},{default:r((t,a,e,s)=>{if(!a)return[d(h,{name:"lucide:circle-user-round",class:["w-6 h-6",u(w)]},null,8,["class"])];a(p(h,{name:"lucide:circle-user-round",class:["w-6 h-6",u(w)]},null,e,s))}),_:1},i)),e("</div>"),e(p(c,null,{},i)),e('</div></section></div></div><section class="flex md:hidden flex-col md:flex-row items-start md:items-center justify-between px-4 md:px-8 py-6 gap-6" data-v-62f73fcd><div class="flex md:hidden items-center justify-between w-full px-2" data-v-62f73fcd><div class="w-[60%] max-w-[200px]" data-v-62f73fcd>'),e(p(n,{to:"/",class:"block"},{default:r((t,a,e,s)=>{if(!a)return[d("img",{src:x,alt:"Earth Man Logo",class:"w-full h-auto max-h-12 object-contain object-left"})];a(`<img${v("src",x)} alt="Earth Man Logo" class="w-full h-auto max-h-12 object-contain object-left" data-v-62f73fcd${s}>`)}),_:1},i)),e('</div><div class="flex items-center gap-4" data-v-62f73fcd>'),e(p(c,null,{},i)),e('<button type="button" aria-label="Open menu" data-v-62f73fcd>'),e(p(h,{name:"lucide:menu",class:["w-7 h-7",u(w)]},null,i)),e("</button></div></div></section></section>")}}}),b=w.setup;w.setup=(t,a)=>{const e=h();return(e.modules||(e.modules=new Set)).add("components/AppNavigation.vue"),b?b(t,a):void 0};const j=a(w,[["__scopeId","data-v-62f73fcd"]]);export{j as _,_ as u};
//# sourceMappingURL=AppNavigation-CyRCE6k1.mjs.map
