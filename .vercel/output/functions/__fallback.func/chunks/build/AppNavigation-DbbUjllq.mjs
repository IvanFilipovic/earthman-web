import{_ as t}from"./nuxt-link-BeJz8Y8C.mjs";import{_ as a,d as e,e as s}from"./server.mjs";import{_ as i}from"./index-DSJLL3Jq.mjs";import{defineComponent as o,ref as l,computed as c,watch as n,withCtx as r,createVNode as d,unref as u,createTextVNode as h,useSSRContext as m}from"vue";import{ssrRenderAttrs as p,ssrRenderComponent as f,ssrRenderAttr as v}from"vue/server-renderer";import{_ as g}from"./virtual_public-Dgbfu3-q.mjs";import{defineStore as y}from"pinia";const x=y("cart",{state:()=>({items:[],totals:{toPay:"0.00"},loading:!1,lastFetched:null}),getters:{itemCount:t=>t.items.reduce((t,a)=>t+a.quantity,0),getVariantQuantity:t=>a=>{const e=t.items.find(t=>t.product_slug===a||t.product_variant_slug===a);return(null==e?void 0:e.quantity)||0},merchandiseTotal:t=>t.items.reduce((t,a)=>t+parseFloat(a.unit_price_discounted||a.unit_price_original)*a.quantity,0),hasItems:t=>t.items.length>0},actions:{async fetchCart(t=!1){const a=Date.now();if(!(!t&&this.lastFetched&&a-this.lastFetched<3e4)){this.loading=!0;try{const t=await $fetch("/api/private/get/cart");this.items=(null==t?void 0:t.items)||[],this.totals={toPay:(null==t?void 0:t.cart_total_to_pay)||"0.00"},this.lastFetched=a}catch(t){console.error("Failed to fetch cart:",t),this.items=[],this.totals={toPay:"0.00"}}finally{this.loading=!1}}},async addToCart(t,a){const e=this.getVariantQuantity(t)+a,s=this.items.find(a=>a.product_slug===t||a.product_variant_slug===t),i=(null==s?void 0:s.quantity)||0;s&&(s.quantity=e);const o=this.merchandiseTotal.toFixed(2);this.totals.toPay=o;try{await $fetch("/api/private/put/cart",{method:"PUT",headers:{"Content-Type":"application/json"},body:{product_slug:t,quantity:e}})}catch(a){if(s)if(i>0)s.quantity=i;else{const a=this.items.findIndex(a=>a.product_slug===t||a.product_variant_slug===t);a>-1&&this.items.splice(a,1)}const e=this.merchandiseTotal.toFixed(2);throw this.totals.toPay=e,a}},async removeFromCart(t){const a=t.product_slug||t.product_variant_slug;if(!a)return void console.error("No slug found in item:",t);const e=this.items.findIndex(t=>t.product_slug===a||t.product_variant_slug===a);if(-1===e)return;const s=this.items.splice(e,1)[0];try{await $fetch(`/api/private/delete/cart?product_slug=${encodeURIComponent(a)}`,{method:"DELETE"});const t=this.merchandiseTotal.toFixed(2);this.totals.toPay=t}catch(t){throw console.error("âŒ removeFromCart - Error:",t),this.items.splice(e,0,s),t}},async updateQuantity(t,a){const e=this.items.find(a=>a.product_slug===t||a.product_variant_slug===t);if(!e)return;const s=e.quantity;e.quantity=a;const i=this.merchandiseTotal.toFixed(2);this.totals.toPay=i;try{await $fetch("/api/private/put/cart",{method:"PUT",headers:{"Content-Type":"application/json"},body:{product_slug:t,quantity:a}})}catch(t){e.quantity=s;const a=this.merchandiseTotal.toFixed(2);throw this.totals.toPay=a,t}},clearCache(){this.lastFetched=null},async clearCart(){const t=[...this.items],a={...this.totals};this.items=[],this.totals={toPay:"0.00"};try{await $fetch("/api/private/cart/clear",{method:"DELETE"})}catch(e){throw this.items=t,this.totals=a,e}}}}),_=o({__name:"AppNavigation",__ssrInlineRender:!0,props:{dark:{type:Boolean,default:!1}},setup(a){const o=a,m=e();x();const y=l(!1),_=l(!1),b=c(()=>o.dark?"text-background_color":"text-text_color");function getNavWeight(t){return function(t){return m.path===t||m.path.startsWith(`${t}/`)}(t)?"font-bold":"font-light"}return n(y,t=>{}),n(_,t=>{}),(a,e,o,l)=>{const c=t,n=s,m=i;e(`<section${p(l)} data-v-b14599c5><div class="hidden md:flex flex-col lg:flex-row w-full z-50" data-v-b14599c5><div class="flex flex-col w-full lg:w-1/2" data-v-b14599c5><div class="absolute inset-x-0 top-0 w-1/2 md:px-8" data-v-b14599c5>`),e(f(c,{to:"/",class:"flex justify-center py-6"},{default:r((t,a,e,s)=>{if(!a)return[d("img",{src:g,alt:"Earth Man Logo",class:"max-w-[100%] h-auto object-contain"})];a(`<img${v("src",g)} alt="Earth Man Logo" class="max-w-[100%] h-auto object-contain" data-v-b14599c5${s}>`)}),_:1},o)),e('</div></div><div class="hidden md:flex w-full items-start justify-end lg:w-1/2 px-4 md:px-8 md:py-14 lg:py-24 gap-6 h-full" data-v-b14599c5><section class="flex flex-col justify-end w-full bg-transparent z-50 my-auto" data-v-b14599c5><div class="flex pt-4" data-v-b14599c5><div class="flex flex-row justify-end w-full mx-auto space-x-4 py-4" data-v-b14599c5>'),e(f(c,{to:"/shop",class:[u(b),getNavWeight("/shop"),"text-sm my-auto px-4"]},{default:r((t,a,e,s)=>{if(!a)return[h(" SHOP ")];a(" SHOP ")}),_:1},o)),e(f(c,{to:"/collections",class:[u(b),getNavWeight("/collections"),"text-sm my-auto px-4"]},{default:r((t,a,e,s)=>{if(!a)return[h(" STORIES ")];a(" STORIES ")}),_:1},o)),e(f(c,{to:"/about",class:[u(b),getNavWeight("/about"),"text-sm my-auto px-4"]},{default:r((t,a,e,s)=>{if(!a)return[h(" ABOUT ")];a(" ABOUT ")}),_:1},o)),e(f(n,null,{},o)),e(f(c,{to:"/profile",class:[u(b),getNavWeight("/profile"),"my-auto font-light pl-4"],"aria-label":"User profile"},{default:r((t,a,e,s)=>{if(!a)return[d(m,{name:"lucide:circle-user-round",class:["w-6 h-6",u(b)]},null,8,["class"])];a(f(m,{name:"lucide:circle-user-round",class:["w-6 h-6",u(b)]},null,e,s))}),_:1},o)),e("</div>"),e(f(n,null,{},o)),e('</div></section></div></div><section class="flex md:hidden flex-col md:flex-row items-start md:items-center justify-between px-4 md:px-8 py-6 gap-6" data-v-b14599c5><div class="flex md:hidden items-center justify-between w-full px-2" data-v-b14599c5><div class="w-[60%] max-w-[200px]" data-v-b14599c5>'),e(f(c,{to:"/",class:"block"},{default:r((t,a,e,s)=>{if(!a)return[d("img",{src:g,alt:"Earth Man Logo",class:"w-full h-auto max-h-12 object-contain object-left"})];a(`<img${v("src",g)} alt="Earth Man Logo" class="w-full h-auto max-h-12 object-contain object-left" data-v-b14599c5${s}>`)}),_:1},o)),e('</div><div class="flex items-center gap-4" data-v-b14599c5>'),e(f(n,null,{},o)),e('<button type="button" aria-label="Open menu" data-v-b14599c5>'),e(f(m,{name:"lucide:menu",class:["w-7 h-7",u(b)]},null,o)),e("</button></div></div></section></section>")}}}),b=_.setup;_.setup=(t,a)=>{const e=m();return(e.modules||(e.modules=new Set)).add("components/AppNavigation.vue"),b?b(t,a):void 0};const w=a(_,[["__scopeId","data-v-b14599c5"]]);export{w as _,x as u};
//# sourceMappingURL=AppNavigation-DbbUjllq.mjs.map
