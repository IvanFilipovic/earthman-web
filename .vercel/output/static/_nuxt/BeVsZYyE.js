import{_ as g}from"./BlJWFypG.js";import{d as P,f as b,n as h}from"#entry";import{C as w,k as i,b as x,D as k,F as u,a3 as e,a7 as C,J as d,a4 as I,N as _,Y as y,X as p,a5 as N}from"./DY7e6STM.js";const B={class:"min-h-screen bg-background_color flex items-center justify-center"},L={class:"max-w-md mx-auto px-4 text-center"},R={key:0,class:"space-y-4"},T={key:1,class:"space-y-4"},q={class:"text-sm text-text_color/70"},M={class:"flex flex-col gap-3 mt-6"},E=w({__name:"success",setup(V){const r=P(),f=b(),n=i(()=>r.query.paymentId),l=i(()=>r.query.PayerID),c=i(()=>r.query.order_ref),s=x(!0),o=x("");async function v(){if(!n.value||!l.value||!c.value){o.value="Missing payment parameters",s.value=!1;return}try{console.log("Executing PayPal payment:",{paymentId:n.value,payerId:l.value,orderRef:c.value});const a=await $fetch(`${f.public.apiBase}/api/paypal/execute/`,{method:"POST",headers:{"Content-Type":"application/json"},body:{payment_id:n.value,payer_id:l.value,order_reference:c.value}});a.success?await h({path:"/thank-you",query:{ref:a.order_reference,total:a.total_price,payment_intent:a.success?"completed":""}}):(o.value="Payment execution failed",s.value=!1)}catch(a){console.error("PayPal execution error:",a),o.value=a?.data?.detail||"Payment failed",s.value=!1}}return k(()=>{v()}),(a,t)=>{const m=g;return p(),u("section",B,[e("div",L,[d(s)?(p(),u("div",R,[...t[0]||(t[0]=[e("div",{class:"animate-spin rounded-full h-16 w-16 border-b-2 border-primary_button_color mx-auto"},null,-1),e("h2",{class:"text-xl uppercase tracking-widest text-text_color"},"Processing Payment...",-1),e("p",{class:"text-sm text-text_color/70"},"Please wait while we confirm your PayPal payment",-1)])])):d(o)?(p(),u("div",T,[t[3]||(t[3]=e("div",{class:"w-16 h-16 bg-error_text_color/10 rounded-full flex items-center justify-center mx-auto"},[e("svg",{class:"w-8 h-8 text-error_text_color",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),t[4]||(t[4]=e("h2",{class:"text-xl uppercase tracking-widest text-error_text_color"},"Payment Failed",-1)),e("p",q,I(d(o)),1),e("div",M,[_(m,{to:"/checkout",class:"btn btn--primary"},{default:y(()=>[...t[1]||(t[1]=[e("span",{class:"btn__text"},"Try Again",-1),e("span",{class:"btn__fill"},null,-1)])]),_:1}),_(m,{to:"/",class:"text-sm underline text-text_color/70 hover:text-text_color"},{default:y(()=>[...t[2]||(t[2]=[N(" Return Home ",-1)])]),_:1})])])):C("",!0)])])}}});export{E as default};
