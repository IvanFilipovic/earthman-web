import{_ as U}from"./wm0FsEjJ.js";import z from"./C1jAaNN0.js";import{m as K,d as V,g as Z,_ as tt}from"#entry";import{Y as D,h as j,G as W,V as H,S as Y,_ as B}from"./DHhpbDuF.js";import{C as N,b as F,k as A,w as L,W as M,X as g,Y as u,N as l,J as e,a3 as t,a5 as $,a4 as v,F as k,a7 as O,L as R,a6 as S,V as et,a8 as b,D as st,q as ot,c as Q}from"./Cvp-EZ-T.js";const G=K("cart",{state:()=>({items:[],totals:{toPay:"0.00"},loading:!1,lastFetched:null}),getters:{itemCount:s=>s.items.reduce((c,i)=>c+i.quantity,0),getVariantQuantity:s=>c=>s.items.find(n=>n.product_slug===c||n.product_variant_slug===c)?.quantity||0,merchandiseTotal:s=>s.items.reduce((c,i)=>{const n=parseFloat(i.unit_price_discounted||i.unit_price_original);return c+n*i.quantity},0),hasItems:s=>s.items.length>0},actions:{async fetchCart(s=!1){const c=Date.now();if(!(!s&&this.lastFetched&&c-this.lastFetched<3e4)){this.loading=!0;try{const n=await $fetch("/api/private/get/cart");this.items=n?.items||[],this.totals={toPay:n?.cart_total_to_pay||"0.00"},this.lastFetched=c}catch(n){console.error("Failed to fetch cart:",n),this.items=[],this.totals={toPay:"0.00"}}finally{this.loading=!1}}},async addToCart(s,c){const n=this.getVariantQuantity(s)+c,a=this.items.find(_=>_.product_slug===s||_.product_variant_slug===s),m=a?.quantity||0;a&&(a.quantity=n);const d=this.merchandiseTotal.toFixed(2);this.totals.toPay=d;try{await $fetch("/api/private/put/cart",{method:"PUT",headers:{"Content-Type":"application/json"},body:{product_slug:s,quantity:n}}),window.dispatchEvent(new CustomEvent("cart:updated",{detail:{source:"store",variant:s,quantity:n}}))}catch(_){if(a)if(m>0)a.quantity=m;else{const o=this.items.findIndex(y=>y.product_slug===s||y.product_variant_slug===s);o>-1&&this.items.splice(o,1)}const p=this.merchandiseTotal.toFixed(2);throw this.totals.toPay=p,_}},async removeFromCart(s){const c=s.product_slug||s.product_variant_slug;if(!c){console.error("No slug found in item:",s);return}const i=this.items.findIndex(a=>a.product_slug===c||a.product_variant_slug===c);if(i===-1)return;const n=this.items.splice(i,1)[0];try{await $fetch(`/api/private/delete/cart?product_slug=${encodeURIComponent(c)}`,{method:"DELETE"});const a=this.merchandiseTotal.toFixed(2);this.totals.toPay=a,window.dispatchEvent(new CustomEvent("cart:updated",{detail:{source:"store",variant:c,action:"remove"}}))}catch(a){throw console.error("❌ removeFromCart - Error:",a),this.items.splice(i,0,n),a}},async updateQuantity(s,c){const i=this.items.find(m=>m.product_slug===s||m.product_variant_slug===s);if(!i)return;const n=i.quantity;i.quantity=c;const a=this.merchandiseTotal.toFixed(2);this.totals.toPay=a;try{await $fetch("/api/private/put/cart",{method:"PUT",headers:{"Content-Type":"application/json"},body:{product_slug:s,quantity:c}}),window.dispatchEvent(new CustomEvent("cart:updated",{detail:{source:"store",variant:s,quantity:c}}))}catch(m){i.quantity=n;const d=this.merchandiseTotal.toFixed(2);throw this.totals.toPay=d,m}},clearCache(){this.lastFetched=null},async clearCart(){const s=[...this.items],c={...this.totals};this.items=[],this.totals={toPay:"0.00"};try{await $fetch("/api/private/cart/clear",{method:"DELETE"}),window.dispatchEvent(new CustomEvent("cart:updated",{detail:{source:"store",action:"clear"}}))}catch(i){throw this.items=s,this.totals=c,i}}}});function at(){const s=(i,n,a={})=>{if(!i)return"";const{quality:m=85,format:d="auto",fit:_="scale-down",height:p}=a,o=i.replace("https://static.earth-man.eu/","");return`https://static.earth-man.eu/cdn-cgi/image/${[`width=${n}`,`quality=${m}`,`format=${d}`,_&&`fit=${_}`,p&&`height=${p}`].filter(Boolean).join(",")}/${o}`};return{getTransformedUrl:s,getResponsiveImages:(i,n=[400,800,1200],a,m={})=>{if(!i)return{srcset:"",sizes:"",src:""};const d=n.map(o=>`${s(i,o,m)} ${o}w`).join(", "),_=a||"100vw",p=s(i,n[n.length-1],m);return{srcset:d,sizes:_,src:p}}}}const nt={class:"fixed inset-0 overflow-hidden"},lt={class:"absolute inset-0 overflow-hidden"},it={class:"pointer-events-none fixed inset-y-0 right-0 flex max-w-full"},rt={class:"px-4 md:px-6 py-5 border-b border-text_color/30"},ct={class:"flex items-baseline justify-between"},dt={class:"flex items-center flex-nowrap gap-2 text-sm"},ut={class:"mx-2 whitespace-nowrap"},pt={class:"mx-2 whitespace-nowrap"},mt={class:"flex-1 overflow-y-auto px-4 md:px-6 py-5 space-y-6"},ft={key:0,class:"space-y-6"},xt=["alt"],_t={class:"flex flex-col"},ht={class:"text-sm md:text-base leading-tight tracking-wider px-3"},yt={class:"text-xs mt-1 tracking-wider px-3"},vt={class:"font-medium"},gt={class:"text-xs mt-1 tracking-wider px-3"},bt={class:"font-medium"},wt={class:"text-right"},Ct={class:"text-sm md:text-base"},kt={key:0,class:"space-x-1"},$t={class:"text-error_text_color"},Tt={class:"line-through text-xs"},Et={key:1},Pt=["disabled","onClick"],jt={key:1,class:"text-sm opacity-70"},Ft=["disabled"],It={class:"py-4 border-t border-text_color/30"},qt={class:"flex items-baseline justify-between"},Bt={class:"text-sm my-auto"},Lt={class:"mt-3 flex items-center justify-between text-base font-medium"},Mt={class:"text-sm my-auto"},Ot={class:"px-6 py-5 border-t border-text_color/30"},Rt={class:"flex flex-col gap-3"},St={key:1,type:"button",class:"btn btn--disabled w-full",disabled:""},Ut=N({__name:"CartPanel",props:{open:{type:Boolean,default:!1}},emits:["update:open"],setup(s,{emit:c}){const i=s,n=c,a=G(),m=F(null),d=F(!1),{getResponsiveImages:_}=at();function p(f){return _(f,[100,200,500],"12vh")}const o=A(()=>a.itemCount===0||d.value);function y(){n("update:open",!1)}function E(f){return f.product_slug||f.product_variant_slug||""}function x(f){return m.value===E(f)}async function h(f){const r=E(f);if(!(!r||m.value)){m.value=r;try{await a.removeFromCart(f)}catch(q){console.error("Failed to remove item:",q)}finally{m.value=null}}}function w(f){return f.toFixed(2)}function T(f){return parseFloat(f.unit_price_discounted||f.unit_price_original)*f.quantity}function P(f){return parseFloat(f.unit_price_original)*f.quantity}async function I(){if(!d.value){d.value=!0;try{await a.clearCart()}catch(f){console.error("Failed to clear cart:",f)}finally{d.value=!1}}}return L(()=>i.open,async f=>{f&&await a.fetchCart(!0)},{immediate:!0}),(f,r)=>{const q=z,J=U;return g(),M(e(Y),{show:s.open,as:"template"},{default:u(()=>[l(e(D),{class:"relative z-[60]",onClose:y},{default:u(()=>[l(e(j),{as:"template",leave:"transition-opacity ease-in duration-500","leave-from":"opacity-100","leave-to":"opacity-0"},{default:u(()=>[...r[0]||(r[0]=[t("div",{class:"fixed inset-0 bg-text_color/30 transition-opacity","aria-hidden":"true"},null,-1)])]),_:1}),t("div",nt,[t("div",lt,[t("div",it,[l(e(j),{as:"template",enter:"transform transition ease-out duration-200","enter-from":"translate-x-full","enter-to":"translate-x-0",leave:"transform transition ease-in duration-500","leave-from":"translate-x-0","leave-to":"translate-x-full"},{default:u(()=>[l(e(W),{class:"pointer-events-auto w-full md:max-w-2xl h-full flex flex-col shadow-xl bg-background_color text-text_color"},{default:u(()=>[t("div",rt,[t("div",ct,[l(e(H),{class:"text-md tracking-wider uppercase"},{default:u(()=>[...r[1]||(r[1]=[$(" Shopping Cart ",-1)])]),_:1}),t("div",dt,[t("span",ut,v(e(a).itemCount)+" "+v(e(a).itemCount===1?"item":"items"),1),r[2]||(r[2]=t("span",{class:"mx-2","aria-hidden":"true"},"|",-1)),t("span",pt,"€"+v(e(a).totals.toPay),1),t("button",{type:"button",class:"ml-2 p-1 inline-flex items-center justify-center hover:bg-text_color/10 shrink-0 rounded transition-colors","aria-label":"Close cart",onClick:y},[l(q,{name:"lucide:x",class:"w-4 h-4"})])])])]),t("div",mt,[e(a).itemCount>0?(g(),k("div",ft,[(g(!0),k(R,null,S(e(a).items,(C,X)=>(g(),k("article",{key:`${C.product_slug}-${X}`,class:"grid grid-cols-[auto,1fr,auto] gap-1"},[t("img",et({ref_for:!0},p(C.avatar_image),{alt:C.product,class:"object-cover border",loading:"lazy"}),null,16,xt),t("div",_t,[t("h3",ht,v(C.product),1),t("div",yt,[r[3]||(r[3]=$(" Size: ",-1)),t("span",vt,v(C.size??"—"),1)]),t("div",gt,[r[4]||(r[4]=$(" Quantity: ",-1)),t("span",bt,v(C.quantity??"—"),1)])]),t("div",wt,[t("div",Ct,[C.unit_price_discounted!==C.unit_price_original?(g(),k("span",kt,[t("span",$t,"€"+v(w(T(C))),1),t("span",Tt,"€"+v(w(P(C))),1)])):(g(),k("span",Et,"€"+v(w(T(C))),1))]),t("button",{type:"button",class:"mt-3 text-xs uppercase tracking-widest border-b border-text_color/30 hover:border-text_color transition-colors disabled:opacity-50",disabled:x(C),onClick:pe=>h(C)},v(x(C)?"Removing...":"Remove item"),9,Pt)])]))),128))])):(g(),k("div",jt," Your cart is empty. ")),r[8]||(r[8]=t("ul",{class:"mt-2 space-y-2 text-xs md:text-sm"},[t("li",{class:"flex gap-2"},[t("span",null,"✓"),t("span",null,"Customer rating 4.5/5.0 (3,700+ reviews) via Trustpilot")]),t("li",{class:"flex gap-2"},[t("span",null,"✓"),t("span",null,"Worldwide shipping")]),t("li",{class:"flex gap-2"},[t("span",null,"✓"),t("span",null,"30 days return policy (14 days for sale items)")])],-1)),e(a).itemCount>0?(g(),k("button",{key:2,type:"button",class:"mt-3 text-xs uppercase tracking-widest border-b border-text_color/30 hover:border-text_color transition-colors disabled:opacity-50",disabled:e(d),onClick:I},v(e(d)?"Clearing...":"Clear Cart"),9,Ft)):O("",!0),t("div",It,[t("div",qt,[r[5]||(r[5]=t("div",{class:"text-xs"},[$(" Subtotal "),t("div",{class:"text-[10px]"},"Prices include VAT, excluding shipping costs")],-1)),t("div",Bt,"€"+v(w(e(a).merchandiseTotal)),1)]),r[7]||(r[7]=t("div",{class:"mt-3 flex items-center justify-between"},[t("div",{class:"text-xs"},"Shipping"),t("div",{class:"text-sm my-auto"},"€0.00")],-1)),t("div",Lt,[r[6]||(r[6]=t("span",null,"Total",-1)),t("span",Mt,"€"+v(w(e(a).merchandiseTotal)),1)])]),r[9]||(r[9]=t("div",{class:"space-y-2"},[t("h4",{class:"text-xs uppercase tracking-widest"},"Secure payment"),t("p",{class:"text-xs leading-relaxed opacity-80"}," Your safety is important to us. Please review our Privacy Policy and Terms and Conditions for complete information. ")],-1))]),t("div",Ot,[t("div",Rt,[e(o)?(g(),k("button",St,[...r[11]||(r[11]=[t("span",{class:"btn__text"},"Checkout",-1),t("span",{class:"btn__fill"},null,-1)])])):(g(),M(J,{key:0,to:"/checkout",class:"btn btn--primary w-full",onClick:y},{default:u(()=>[...r[10]||(r[10]=[t("span",{class:"btn__text"},"Checkout",-1),t("span",{class:"btn__fill"},null,-1)])]),_:1}))])])]),_:1})]),_:1})])])])]),_:1})]),_:1},8,["show"])}}}),zt={class:"fixed inset-0 overflow-hidden w-[80%]"},Nt={class:"absolute inset-0 overflow-hidden w-[80%]"},At={class:"pointer-events-none fixed inset-y-0 right-0 flex w-[80%]"},Qt={class:"flex items-baseline justify-center"},Vt={class:"flex flex-col items-end overflow-y-auto py-5 space-y-6"},Dt={class:"flex flex-col items-end overflow-y-auto py-5 space-y-6"},Wt={class:"font-bold mb-4 uppercase px-4"},Ht={class:"space-y-4 text-xs px-4 uppercase my-auto items-end flex flex-col"},Yt={class:"flex flex-col items-end overflow-y-auto py-5 space-y-6"},Gt={class:"flex flex-col items-end"},Jt={class:"space-y-4 text-xs px-4 uppercase my-auto items-end flex flex-row"},Xt=N({__name:"MobileMenu",props:{open:{type:Boolean,default:!1},dark:{type:Boolean,default:!1}},emits:["update:open"],setup(s,{emit:c}){const i=s,n=V(),a=[{title:"Help",links:[{label:"Contact Us",href:"/"},{label:"FAQs",href:"/"},{label:"Delivery and Returns",href:"/"},{label:"Size Guide",href:"/"}]},{title:"Legal",links:[{label:"Privacy Policy",href:"/"},{label:"Terms and Conditions",href:"/"}]}],m=p=>n.path===p||n.path.startsWith(p+"/"),d=p=>m(p)?"font-bold":"font-light",_=A(()=>i.dark?"text-background_color":"text-text_color");return(p,o)=>{const y=U,E=z;return g(),M(e(Y),{show:s.open,as:"template"},{default:u(()=>[l(e(D),{class:"relative z-50",onClose:o[7]||(o[7]=x=>p.$emit("update:open",!1))},{default:u(()=>[l(e(j),{as:"template",leave:"transition-opacity ease-in duration-500","leave-from":"opacity-100","leave-to":"opacity-0"},{default:u(()=>[...o[8]||(o[8]=[t("div",{class:"fixed inset-0 bg-text_color/30 transition-opacity","aria-hidden":"true"},null,-1)])]),_:1}),t("div",zt,[t("div",Nt,[t("div",At,[l(e(j),{as:"template",enter:"transform transition ease-out duration-200","enter-from":"translate-x-full","enter-to":"translate-x-0",leave:"transform transition ease-in duration-500","leave-from":"translate-x-0","leave-to":"translate-x-full"},{default:u(()=>[l(e(W),{class:b(["pointer-events-auto w-full md:max-w-2xl h-full flex flex-col shadow-xl",s.dark?"bg-text_color text-background_color":"bg-background_color text-text_color"])},{default:u(()=>[t("div",{class:b(["px-4 md:px-8 py-6 gap-6 border-b",s.dark?"border-background_color":"border-text_color/30"])},[t("div",Qt,[l(e(H),{class:"text-md tracking-wider uppercase"},{default:u(()=>[l(y,{to:"/",class:"flex mx-auto max-w-[100%]",onClick:o[0]||(o[0]=x=>p.$emit("update:open",!1))},{default:u(()=>[...o[9]||(o[9]=[t("img",{src:B,alt:"Logo",class:"w-full h-auto max-h-12 object-contain object-left"},null,-1)])]),_:1})]),_:1})])],2),t("div",Vt,[l(y,{to:"/shop",class:b([e(_),d("/shop"),"text-sm my-auto px-4"]),onClick:o[1]||(o[1]=x=>p.$emit("update:open",!1))},{default:u(()=>[...o[10]||(o[10]=[$(" SHOP ",-1)])]),_:1},8,["class"]),l(y,{to:"/collections",class:b([e(_),d("/collections"),"text-sm my-auto px-4"]),onClick:o[2]||(o[2]=x=>p.$emit("update:open",!1))},{default:u(()=>[...o[11]||(o[11]=[$(" STORIES ",-1)])]),_:1},8,["class"]),l(y,{to:"/about",class:b([e(_),d("/about"),"text-sm my-auto px-4"]),onClick:o[3]||(o[3]=x=>p.$emit("update:open",!1))},{default:u(()=>[...o[12]||(o[12]=[$(" ABOUT ",-1)])]),_:1},8,["class"])]),t("div",Dt,[(g(),k(R,null,S(a,(x,h)=>t("div",{key:h,class:"flex flex-col items-end"},[t("h3",Wt,v(x.title),1),t("ul",Ht,[(g(!0),k(R,null,S(x.links,(w,T)=>(g(),k("li",{key:T},[l(y,{to:w.href,class:"hover:underline",onClick:o[4]||(o[4]=P=>p.$emit("update:open",!1))},{default:u(()=>[$(v(w.label),1)]),_:2},1032,["to"])]))),128))])])),64))]),t("div",Yt,[t("div",Gt,[o[13]||(o[13]=t("h3",{class:"font-bold mb-4 uppercase px-4"},"Social",-1)),t("ul",Jt,[t("li",null,[l(y,{to:"/f",class:"hover:underline pl-4",onClick:o[5]||(o[5]=x=>p.$emit("update:open",!1))},{default:u(()=>[l(E,{name:"lucide:instagram",class:b(["w-5 h-5",e(_)])},null,8,["class"])]),_:1})]),t("li",null,[l(y,{to:"/",class:"hover:underline pl-4",onClick:o[6]||(o[6]=x=>p.$emit("update:open",!1))},{default:u(()=>[l(E,{name:"lucide:facebook",class:b(["w-5 h-5",e(_)])},null,8,["class"])]),_:1})])])])])]),_:1},8,["class"])]),_:1})])])])]),_:1})]),_:1},8,["show"])}}}),Kt={class:"hidden md:flex flex-col lg:flex-row w-full z-50"},Zt={class:"flex flex-col w-full lg:w-1/2"},te={class:"absolute inset-x-0 top-0 w-1/2 md:px-8"},ee={class:"hidden md:flex w-full items-start justify-end lg:w-1/2 px-4 md:px-8 md:py-14 lg:py-24 gap-6 h-full"},se={class:"flex flex-col justify-end w-full bg-transparent z-50 my-auto"},oe={class:"flex pt-4"},ae={class:"flex flex-row justify-end w-full mx-auto space-x-4 py-4"},ne=["aria-label"],le={class:"flex md:hidden flex-col md:flex-row items-start md:items-center justify-between px-4 md:px-8 py-6 gap-6"},ie={class:"flex md:hidden items-center justify-between w-full px-2"},re={class:"w-[60%] max-w-[200px]"},ce={class:"flex items-center gap-4"},de=["aria-label"],ue=N({__name:"AppNavigation",props:{dark:{type:Boolean,default:!1}},setup(s){const c=s,i=V(),n=G(),a=F(!1),m=F(!1),d=A(()=>c.dark?"text-background_color":"text-text_color");function _(x){return i.path===x||i.path.startsWith(`${x}/`)}function p(x){return _(x)?"font-bold":"font-light"}function o(){a.value=!0}function y(){m.value=!0}function E(){n.fetchCart(!0)}return L(a,x=>{window.dispatchEvent(new CustomEvent(x?"panel:open":"panel:close"))}),L(m,x=>{window.dispatchEvent(new CustomEvent(x?"panel:open":"panel:close"))}),st(async()=>{await n.fetchCart(),window.addEventListener("cart:updated",E)}),ot(()=>{window.removeEventListener("cart:updated",E)}),(x,h)=>{const w=U,T=z,P=Z,I=Ut,f=Xt;return g(),k("section",null,[t("div",Kt,[t("div",Zt,[t("div",te,[l(w,{to:"/",class:"flex justify-center py-6"},{default:u(()=>[...h[2]||(h[2]=[t("img",{src:B,alt:"Earth Man Logo",class:"max-w-[100%] h-auto object-contain"},null,-1)])]),_:1})])]),t("div",ee,[t("section",se,[t("div",oe,[t("div",ae,[l(w,{to:"/shop",class:b([e(d),p("/shop"),"text-sm my-auto px-4"])},{default:u(()=>[...h[3]||(h[3]=[$(" SHOP ",-1)])]),_:1},8,["class"]),l(w,{to:"/collections",class:b([e(d),p("/collections"),"text-sm my-auto px-4"])},{default:u(()=>[...h[4]||(h[4]=[$(" STORIES ",-1)])]),_:1},8,["class"]),l(w,{to:"/about",class:b([e(d),p("/about"),"text-sm my-auto px-4"])},{default:u(()=>[...h[5]||(h[5]=[$(" ABOUT ",-1)])]),_:1},8,["class"]),l(P,null,{default:u(()=>[t("button",{type:"button",class:b(["relative my-auto px-4 cursor-pointer",[e(d),p("/cart")]]),onClick:o,"aria-label":"Open shopping cart"},[l(T,{name:"lucide:shopping-cart",class:b(["w-6 h-6",e(d)])},null,8,["class"]),e(n).itemCount>0?(g(),k("span",{key:0,class:"absolute -top-1 -right-1 bg-text_color text-background_color text-[12px] w-4 h-4 flex items-center justify-center","aria-label":`${e(n).itemCount} items in cart`},v(e(n).itemCount),9,ne)):O("",!0)],2)]),_:1}),l(w,{to:"/profile",class:b([e(d),p("/profile"),"my-auto font-light pl-4"]),"aria-label":"User profile"},{default:u(()=>[l(T,{name:"lucide:circle-user-round",class:b(["w-6 h-6",e(d)])},null,8,["class"])]),_:1},8,["class"])]),l(P,null,{default:u(()=>[l(I,{open:e(a),"onUpdate:open":h[0]||(h[0]=r=>Q(a)?a.value=r:null)},null,8,["open"]),l(f,{open:e(m),"onUpdate:open":h[1]||(h[1]=r=>Q(m)?m.value=r:null)},null,8,["open"])]),_:1})])])])]),t("section",le,[t("div",ie,[t("div",re,[l(w,{to:"/",class:"block"},{default:u(()=>[...h[6]||(h[6]=[t("img",{src:B,alt:"Earth Man Logo",class:"w-full h-auto max-h-12 object-contain object-left"},null,-1)])]),_:1})]),t("div",ce,[l(P,null,{default:u(()=>[t("button",{type:"button",class:b(["relative cursor-pointer",e(d)]),onClick:o,"aria-label":"Open shopping cart"},[l(T,{name:"lucide:shopping-cart",class:b(["w-6 h-6",e(d)])},null,8,["class"]),e(n).itemCount>0?(g(),k("span",{key:0,class:"absolute -top-1 -right-1 bg-text_color text-background_color text-[10px] w-[14px] h-[14px] md:text-[12px] md:w-4 md:h-4 flex items-center justify-center","aria-label":`${e(n).itemCount} items in cart`},v(e(n).itemCount),9,de)):O("",!0)],2)]),_:1}),t("button",{type:"button",onClick:y,"aria-label":"Open menu"},[l(T,{name:"lucide:menu",class:b(["w-7 h-7",e(d)])},null,8,["class"])])])])])])}}}),ye=tt(ue,[["__scopeId","data-v-b14599c5"]]);export{ye as _,G as a,at as u};
